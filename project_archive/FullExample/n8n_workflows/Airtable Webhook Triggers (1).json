{
  "name": "Airtable Webhook Triggers",
  "nodes": [
    {
      "parameters": {
        "jsCode": "// Parse Airtable record en extract invoice data\nfunction extractInvoiceDataFromAirtable(airtableFields) {\n  // Valideer input\n  if (!airtableFields || typeof airtableFields !== 'object') {\n    console.log('Warning: airtableFields is empty or not an object:', airtableFields);\n    return {\n      error: 'Invalid or missing Airtable fields',\n      success: false\n    };\n  }\n  \n  try {\n    // Object voor invoice data\n    const invoiceData = {\n      success: true,\n      source: 'airtable'\n    };\n    \n    // Extract Factuur ID\n    if (airtableFields['Factuur ID']) {\n      invoiceData.factuur_id = airtableFields['Factuur ID'];\n    }\n    \n    // Extract Opdrachtnummer\n    if (airtableFields['Opdrachtnummer']) {\n      invoiceData.opdrachtnummer = airtableFields['Opdrachtnummer'];\n    }\n    \n    // Extract Type Factuur (kan object of string zijn)\n    if (airtableFields['Type Factuur']) {\n      if (typeof airtableFields['Type Factuur'] === 'object' && airtableFields['Type Factuur'].name) {\n        invoiceData.type_factuur = airtableFields['Type Factuur'].name;\n        invoiceData.type_factuur_id = airtableFields['Type Factuur'].id;\n        invoiceData.type_factuur_color = airtableFields['Type Factuur'].color;\n      } else {\n        invoiceData.type_factuur = airtableFields['Type Factuur'];\n      }\n    }\n    \n    // Extract Factuurtitel - EXTRA DEBUG\n    console.log('Factuurtitel found:', !!airtableFields['Factuurtitel']);\n    console.log('Factuurtitel value:', airtableFields['Factuurtitel']);\n    if (airtableFields['Factuurtitel']) {\n      invoiceData.factuurtitel = airtableFields['Factuurtitel'];\n      console.log('Factuurtitel assigned:', invoiceData.factuurtitel);\n    }\n    \n    // Extract Bedrag\n    if (airtableFields['Bedrag'] && typeof airtableFields['Bedrag'] === 'number') {\n      invoiceData.bedrag = airtableFields['Bedrag'];\n    }\n    \n    // Extract Status (kan object of string zijn)\n    if (airtableFields['Status']) {\n      if (typeof airtableFields['Status'] === 'object' && airtableFields['Status'].name) {\n        invoiceData.status = airtableFields['Status'].name;\n        invoiceData.status_id = airtableFields['Status'].id;\n        invoiceData.status_color = airtableFields['Status'].color;\n      } else {\n        invoiceData.status = airtableFields['Status'];\n      }\n    }\n    \n    // Extract Klant naam\n    if (airtableFields['Klant']) {\n      invoiceData.klant_naam = airtableFields['Klant'];\n    }\n    \n    // Extract Email\n    if (airtableFields['Email']) {\n      invoiceData.email = airtableFields['Email'];\n    }\n    \n    // Extract Telefoon\n    if (airtableFields['Telefoon']) {\n      invoiceData.telefoon = airtableFields['Telefoon'];\n    }\n    \n    // Extract en parse Adres\n    if (airtableFields['Adres']) {\n      const adresText = airtableFields['Adres'].trim();\n      const adresLines = adresText.split('\\n');\n      \n      if (adresLines.length >= 2) {\n        // Verwacht formaat: \"Straat huisnummer\\nPostcode Plaats\"\n        const straatLine = adresLines[0].trim();\n        const postcodeplaatsLine = adresLines[1].trim();\n        const postcodeplaatsParts = postcodeplaatsLine.split(' ');\n        \n        invoiceData.adres = {\n          straat: straatLine,\n          postcode: postcodeplaatsParts.slice(0, 2).join(' '), // \"5644NK\" -> \"5644 NK\"\n          plaats: postcodeplaatsParts.slice(2).join(' ')\n        };\n        \n        // Als postcode geen spatie heeft, voeg deze toe voor Nederlandse postcodes\n        if (invoiceData.adres.postcode && !invoiceData.adres.postcode.includes(' ') && invoiceData.adres.postcode.length === 6) {\n          invoiceData.adres.postcode = invoiceData.adres.postcode.slice(0, 4) + ' ' + invoiceData.adres.postcode.slice(4);\n        }\n      } else {\n        // Fallback: volledige adres als één veld\n        invoiceData.adres = {\n          volledig: adresText\n        };\n      }\n    }\n    \n    // Bereken BTW bedragen (Nederlandse BTW 21%)\n    if (invoiceData.bedrag && !isNaN(invoiceData.bedrag)) {\n      invoiceData.btw_percentage = 21;\n      invoiceData.bedrag_excl_btw = Math.round((invoiceData.bedrag / 1.21) * 100) / 100;\n      invoiceData.btw_bedrag = Math.round((invoiceData.bedrag - invoiceData.bedrag_excl_btw) * 100) / 100;\n    }\n    \n    // Voeg huidige datum toe\n    const today = new Date();\n    invoiceData.datum = today.toLocaleDateString('nl-NL', {\n      day: '2-digit',\n      month: '2-digit', \n      year: 'numeric'\n    });\n    \n    // Voeg vervaldag toe (30 dagen)\n    const dueDate = new Date(today);\n    dueDate.setDate(dueDate.getDate() + 30);\n    invoiceData.vervaldatum = dueDate.toLocaleDateString('nl-NL', {\n      day: '2-digit',\n      month: '2-digit',\n      year: 'numeric'\n    });\n    \n    return invoiceData;\n    \n  } catch (error) {\n    console.error('Error parsing Airtable data:', error);\n    return {\n      error: `Parsing failed: ${error.message}`,\n      success: false\n    };\n  }\n}\n\n// Main execution\ntry {\n  // Debug: log de volledige input structuur\n  const inputData = $input.first().json;\n  console.log('Full input structure:', JSON.stringify(inputData, null, 2));\n  \n  // Extract Airtable fields\n  const airtableFields = inputData.body?.fields;\n  \n  if (!airtableFields) {\n    throw new Error('No Airtable fields found in webhook data');\n  }\n  \n  // Debug: log de fields\n  console.log('Airtable fields found:', Object.keys(airtableFields));\n  console.log('Fields content:', JSON.stringify(airtableFields, null, 2));\n  \n  // Parse de data\n  const invoiceData = extractInvoiceDataFromAirtable(airtableFields);\n  \n  // Voeg record_id toe voor referentie\n  if (inputData.body?.record_id) {\n    invoiceData.airtable_record_id = inputData.body.record_id;\n  }\n  \n  // Log resultaat voor debugging\n  console.log('Extracted Invoice Data:', JSON.stringify(invoiceData, null, 2));\n  \n  // Return de geparseerde data voor de volgende node\n  return {\n    json: invoiceData\n  };\n  \n} catch (error) {\n  console.error('Critical error in invoice processing:', error);\n  \n  // Return error informatie voor debugging\n  return {\n    json: {\n      error: `Critical processing error: ${error.message}`,\n      success: false,\n      input_available: !!$input.first(),\n      input_keys: $input.first() ? Object.keys($input.first().json) : [],\n      timestamp: new Date().toISOString()\n    }\n  };\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -480,
        -288
      ],
      "id": "69f3a926-e524-47b1-ae4c-e32f0823e715",
      "name": "Code"
    },
    {
      "parameters": {
        "jsCode": "// Extract element data from webhook\nconst elementData = $input.first().json.body.element;\nconst mapping = $input.first().json.body.production_mapping;\n\n// Validate required fields\nif (!elementData.element_id || !elementData.opdrachtnummer) {\n    throw new Error('Missing required element data');\n}\n\n// Prepare data for next steps\nreturn {\n    json: {\n        element: elementData,\n        mapping: mapping,\n        project_opdrachtnummer: elementData.opdrachtnummer,\n        target_base_id: \"appoYgxrhYZP5MAVT\"\n    }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -256,
        160
      ],
      "id": "8b0d781e-adcf-40be-9ea5-d6c5ff0d2de3",
      "name": "Code1"
    },
    {
      "parameters": {
        "jsCode": "// N8N Code Node: Process Complete Deur Specifications for Production\nconst items = $input.all();\n\nreturn items.map(item => {\n  const webhookData = item.json;\n  const deurSpecs = webhookData.body?.deur_specs || {};\n  \n  // Extract element mark from full Element ID (get part after \" - \")\n  const elementMerk = (deurSpecs.element_id || '').split(' - ').pop() || '';\n  \n  // Current date for sync timestamp\n  const currentDate = new Date().toISOString().split('T')[0];\n  \n  // Mapping functions for production format\n  const mapProfielType = (value) => {\n    if (!value) return \"Standaard\";\n    if (value === \"Verdiept\") return \"Standaard\";\n    if (value === \"Vlak\") return \"HVL\";\n    return \"Standaard\";\n  };\n  \n  const mapKozijnType = (value) => {\n    if (!value) return \"Stomp\";\n    // Direct mapping: \"Stomp\" -> \"Stomp\", \"Aanslag\" -> \"Aanslag\"\n    return value;\n  };\n  \n  const mapCilinderType = (value) => {\n    if (!value) return \"Sleutelcilinder\";\n    // Map to production values\n    const mapping = {\n      \"Sleutelcilinder\": \"Sleutelcilinder\",\n      \"Elektronisch\": \"Elektronisch\"\n    };\n    return mapping[value] || \"Sleutelcilinder\";\n  };\n  \n  const mapGelijksluitend = (value) => {\n    if (!value || value === \"Nee\") return \"Nee\";\n    if (value === \"Ja\") return \"Ja, nieuwe set\";\n    return \"Nee\";\n  };\n  \n  const mapGlasType = (value) => {\n    if (!value) return \"Helder glas\";\n    const v = value.toLowerCase();\n    if (v.includes('melk') || v.includes('gezandstraald')) return \"Melkglas\";\n    if (v.includes('gelaagd')) return \"Gelaagd glas\";\n    return \"Helder glas\";\n  };\n  \n  const mapBrevenbus = (value) => {\n    return (value && value !== \"Nee\") ? \"Ja\" : \"Nee\";\n  };\n  \n  const mapAfwatering = (value) => {\n    if (!value) return \"Onderkant\";\n    // Direct mapping\n    return value;\n  };\n  \n  const mapBinnenafwerking = (value) => {\n    if (!value) return \"Kap 6\";\n    if (value.includes(\"Kap 6\")) return \"Kap 6\";\n    if (value.includes(\"Kap 10\")) return \"Kap 10\";\n    return \"Overig\";\n  };\n  \n  const mapDraairichting = (value) => {\n    if (!value || value === \"Wordt met inmeten bepaald\") return null;\n    \n    // Map sales values to production values\n    const mapping = {\n      \"Links draaiend\": \"Links binnendraaiend\",\n      \"Rechts draaiend\": \"Rechts binnendraaiend\",\n      \"Links binnendraaiend\": \"Links binnendraaiend\",\n      \"Rechts binnendraaiend\": \"Rechts binnendraaiend\",\n      \"Links buitendraaiend\": \"Links buitendraaiend\", \n      \"Rechts buitendraaiend\": \"Rechts buitendraaiend\"\n    };\n    \n    return mapping[value] || null;\n  };\n  \n  return {\n    json: {\n      // Basic Identification\n      \"Opdrachtnummer\": deurSpecs.opdrachtnummer,\n      \"Element ID (Merk)\": elementMerk,\n      \"Soort Deur\": deurSpecs.element_type,\n      \"Plaats\": deurSpecs.locatie,\n      \n      // Sales Sync Fields\n      \"Sales Element ID\": deurSpecs.element_id,\n      \"Sales Sync Status\": \"Gesynchroniseerd\",\n      \"Sales Sync Timestamp\": currentDate,\n      \n      // Original Dimensions\n      \"Oorspronkelijke Breedte (mm)\": deurSpecs.breedte_mm,\n      \"Oorspronkelijke Hoogte (mm)\": deurSpecs.hoogte_mm,\n      \n      // Deur Specifications - COMPLETE from sales!\n      \"Model Deur\": deurSpecs.model_deur,\n      \"Type Profiel\": mapProfielType(deurSpecs.type_profiel),\n      \"Type Kozijn (Constructie)\": mapKozijnType(deurSpecs.type_kozijn),\n      \"Draairichting\": mapDraairichting(deurSpecs.draairichting),\n      \n      // Complete Color Specifications\n      \"Kleur Kozijn Binnen\": deurSpecs.kleur_kozijn_binnen,\n      \"Kleur Kozijn Buiten\": deurSpecs.kleur_kozijn_buiten,\n      \"Kleur Deurvleugel Binnen\": deurSpecs.kleur_deurvleugel_binnen,\n      \"Kleur Deurvleugel Buiten\": deurSpecs.kleur_deurvleugel_buiten,\n      \n      // Complete Hardware Specifications\n      \"Deurbeslag Buiten\": deurSpecs.deurbeslag_buiten,\n      \"Deurbeslag Binnen\": deurSpecs.deurbeslag_binnen,\n      \"Staafgreep Specificatie\": deurSpecs.staafgreep_specificatie,\n      \"Cilinder Type\": mapCilinderType(deurSpecs.type_cilinder),\n      \"Cilinder Gelijksluitend\": mapGelijksluitend(deurSpecs.cilinder_gelijksluitend),\n      \n      // Glass and Features\n      \"Glas Deurvleugel\": mapGlasType(deurSpecs.glas_deurvleugel),\n      \"Brievenbus\": mapBrevenbus(deurSpecs.brievenbus),\n      \"Afwatering\": mapAfwatering(deurSpecs.afwatering),\n      \"Binnenafwerking Detail\": mapBinnenafwerking(deurSpecs.binnenafwerking),\n      \n      // Door-specific details\n      \"Hardstenen Dorpel Specificatie\": deurSpecs.soort_onderdorpel,\n      \n      // Commercial Reference\n      \"Definitieve Element Prijs\": deurSpecs.definitieve_element_prijs,\n      \n      // Comprehensive sales specifications for reference\n      \"Verkoop Specificaties\": `COMPLETE DEUR SPECIFICATIES - ${deurSpecs.element_id}\n================================================================\n\nELEMENT INFORMATIE:\n- Type: ${deurSpecs.element_type}\n- Model: ${deurSpecs.model_deur}\n- Locatie: ${deurSpecs.locatie}\n- Afmetingen: ${deurSpecs.geoffreerde_afmetingen}\n- Prijs: €${deurSpecs.definitieve_element_prijs}\n\nCONSTRUCTIE DETAILS:\n- Profiel type: ${deurSpecs.type_profiel}\n- Kozijn type: ${deurSpecs.type_kozijn}\n- Draairichting: ${deurSpecs.draairichting}\n\nKLEURSPECIFICATIES:\n- Kozijn binnen: ${deurSpecs.kleur_kozijn_binnen}\n- Kozijn buiten: ${deurSpecs.kleur_kozijn_buiten}\n- Deurvleugel binnen: ${deurSpecs.kleur_deurvleugel_binnen}\n- Deurvleugel buiten: ${deurSpecs.kleur_deurvleugel_buiten}\n\nHARDWARE SPECIFICATIES:\n- Deurbeslag buiten: ${deurSpecs.deurbeslag_buiten}\n- Deurbeslag binnen: ${deurSpecs.deurbeslag_binnen}\n- Staafgreep: ${deurSpecs.staafgreep_specificatie}\n- Scharnieren binnen: ${deurSpecs.scharnieren_binnen}\n- Cilinder type: ${deurSpecs.type_cilinder}\n- Gelijksluitend: ${deurSpecs.cilinder_gelijksluitend}\n\nOVERIGE SPECIFICATIES:\n- Glas deurvleugel: ${deurSpecs.glas_deurvleugel}\n- Onderdorpel: ${deurSpecs.soort_onderdorpel}\n- Brievenbus: ${deurSpecs.brievenbus}\n- Afwatering: ${deurSpecs.afwatering}\n- Binnenafwerking: ${deurSpecs.binnenafwerking}\n\nSYNCHRONISATIE INFO:\n- Sales record ID: ${deurSpecs.record_id}\n- Sync datum: ${currentDate}\n- Status: Gecontroleerd door verkoop`,\n\n      \"Sales Review Notities\": deurSpecs.opmerkingen_binnendienst || deurSpecs.review_notities || '',\n      \n      // Initial production status - clear fields for inmeter to fill\n      \"Inmeet Status\": \"Nog niet ingemeten\",\n      \"Breedte Binnenmaat (mm)\": null,\n      \"Hoogte Binnenmaat (mm)\": null,\n      \"Breedte Buitenmaat (mm)\": null,\n      \"Hoogte Buitenmaat (mm)\": null,\n      \"Peilmaat\": null,\n      \"Afwijkende Beglazing\": null,\n      \"Afwijkende Kleuren\": null,\n      \"Gevelbekleding Specificatie\": null,\n      \"Montage Notities (Inmeter)\": null,\n      \"Afwijkingen Notities (Inmeter)\": null\n    }\n  };\n});"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -480,
        -64
      ],
      "id": "cd5b9a07-95ba-45b8-b8d3-03423f56a7fd",
      "name": "Code2"
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "appoYgxrhYZP5MAVT",
          "mode": "list",
          "cachedResultName": "STB-Productie",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT"
        },
        "table": {
          "__rl": true,
          "value": "tbl17ky1ueWh1CvNt",
          "mode": "list",
          "cachedResultName": "Elementen",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT/tbl17ky1ueWh1CvNt"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Oorspronkelijke Hoogte (mm)": "={{ $json.element.hoogte_mm }}",
            "Breedte Binnenmaat (mm)": 0,
            "Hoogte Binnenmaat (mm)": 0,
            "Breedte Buitenmaat (mm)": 0,
            "Hoogte Buitenmaat (mm)": 0,
            "Opdrachtnummer": "={{ $json.element.opdrachtnummer }}",
            "Element ID (Merk)": "={{ $json.element.element_id }}",
            "Soort Element": "={{ $json.element.element_type }}",
            "Plaats": "={{ $json.element.locatie }}",
            "Oorspronkelijke Breedte (mm)": "={{ $json.element.breedte_mm }}",
            "Afwatering": "Onderkant",
            "Type Kozijn (Constructie)": "Stomp",
            "Binnenafwerking Detail": "Kap 6",
            "Inmeet Status": "Nog niet ingemeten",
            "Profielstijl (indien afwijkend)": "Verdiept, zonder houtlookverbinding",
            "Sales Review Notities": "={{ $json.element.review_notities }}",
            "Verkoop Specificaties": "={{ $json.element.alle_regelitems_detail }}"
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Opdrachtnummer",
              "displayName": "Opdrachtnummer",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Element ID (Merk)",
              "displayName": "Element ID (Merk)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Soort Element",
              "displayName": "Soort Element",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Plaats",
              "displayName": "Plaats",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Breedte (mm)",
              "displayName": "Oorspronkelijke Breedte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Hoogte (mm)",
              "displayName": "Oorspronkelijke Hoogte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Verkoop Specificaties",
              "displayName": "Verkoop Specificaties",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Sales Review Notities",
              "displayName": "Sales Review Notities",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Elementen (Nested)",
              "displayName": "Elementen (Nested)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "array",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "From field: Elementen (Nested)",
              "displayName": "From field: Elementen (Nested)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "array",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Binnenmaat (mm)",
              "displayName": "Breedte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Binnenmaat (mm)",
              "displayName": "Hoogte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Buitenmaat (mm)",
              "displayName": "Breedte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Buitenmaat (mm)",
              "displayName": "Hoogte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Projecten",
              "displayName": "Projecten",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "array",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Draairichting",
              "displayName": "Draairichting",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Links binnendraaiend",
                  "value": "Links binnendraaiend"
                },
                {
                  "name": "Rechts binnendraaiend",
                  "value": "Rechts binnendraaiend"
                },
                {
                  "name": "Links buitendraaiend",
                  "value": "Links buitendraaiend"
                },
                {
                  "name": "Rechts buitendraaiend",
                  "value": "Rechts buitendraaiend"
                },
                {
                  "name": "Dubbeldeuren (zie notities)",
                  "value": "Dubbeldeuren (zie notities)"
                },
                {
                  "name": "Schuifrichting links",
                  "value": "Schuifrichting links"
                },
                {
                  "name": "Schuifrichting rechts",
                  "value": "Schuifrichting rechts"
                },
                {
                  "name": "Valraam",
                  "value": "Valraam"
                },
                {
                  "name": "Vast (geen)",
                  "value": "Vast (geen)"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Type Kozijn (Constructie)",
              "displayName": "Type Kozijn (Constructie)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Stomp",
                  "value": "Stomp"
                },
                {
                  "name": "Aanslag",
                  "value": "Aanslag"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwatering",
              "displayName": "Afwatering",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Onderkant",
                  "value": "Onderkant"
                },
                {
                  "name": "Voorkant",
                  "value": "Voorkant"
                },
                {
                  "name": "N.v.t.",
                  "value": "N.v.t."
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Binnenafwerking Detail",
              "displayName": "Binnenafwerking Detail",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Kap 6",
                  "value": "Kap 6"
                },
                {
                  "name": "Kap 10",
                  "value": "Kap 10"
                },
                {
                  "name": "Overig (zie notities)",
                  "value": "Overig (zie notities)"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Details Extra Profielen",
              "displayName": "Details Extra Profielen",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Montage Notities (Inmeter)",
              "displayName": "Montage Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkingen Notities (Inmeter)",
              "displayName": "Afwijkingen Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Beglazing (inmeter)",
              "displayName": "Afwijkende Beglazing (inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Kleuren (inmeter)",
              "displayName": "Afwijkende Kleuren (inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Profielstijl (indien afwijkend)",
              "displayName": "Profielstijl (indien afwijkend)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Vlak, zonder houtlookverbinding",
                  "value": "Vlak, zonder houtlookverbinding"
                },
                {
                  "name": "Vlak, met houtlookverbinding",
                  "value": "Vlak, met houtlookverbinding"
                },
                {
                  "name": "Verdiept, zonder houtlookverbinding",
                  "value": "Verdiept, zonder houtlookverbinding"
                },
                {
                  "name": "Verdiept, met houtlookverbinding",
                  "value": "Verdiept, met houtlookverbinding"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Inmeet Status",
              "displayName": "Inmeet Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Nog niet ingemeten",
                  "value": "Nog niet ingemeten"
                },
                {
                  "name": "Inmeten voltooid",
                  "value": "Inmeten voltooid"
                },
                {
                  "name": "Overleg nodig na inmeten",
                  "value": "Overleg nodig na inmeten"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Deur Specificaties",
              "displayName": "Deur Specificaties",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -32,
        160
      ],
      "id": "43fcbfc6-6e53-4458-aeb9-a60dd26d6dcf",
      "name": "Airtable Kozijn Elementen",
      "credentials": {
        "airtableTokenApi": {
          "id": "ax9Wtoz0YZou3bVH",
          "name": "Airtable Personal Access Token STB-kozijnen Workspace"
        }
      }
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "appoYgxrhYZP5MAVT",
          "mode": "list",
          "cachedResultName": "STB-Productie",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT"
        },
        "table": {
          "__rl": true,
          "value": "tblcKnVFXwv8et3cL",
          "mode": "list",
          "cachedResultName": "Deur Elementen",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT/tblcKnVFXwv8et3cL"
        },
        "columns": {
          "mappingMode": "autoMapInputData",
          "value": {
            "Oorspronkelijke Breedte (mm)": 0,
            "Oorspronkelijke Hoogte (mm)": 0,
            "Breedte Binnenmaat (mm)": 0,
            "Hoogte Binnenmaat (mm)": 0,
            "Breedte Buitenmaat (mm)": 0,
            "Hoogte Buitenmaat (mm)": 0,
            "Peilmaat": 0
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Opdrachtnummer",
              "displayName": "Opdrachtnummer",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Element ID (Merk)",
              "displayName": "Element ID (Merk)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Soort Deur",
              "displayName": "Soort Deur",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Plaats",
              "displayName": "Plaats",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Breedte (mm)",
              "displayName": "Oorspronkelijke Breedte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Hoogte (mm)",
              "displayName": "Oorspronkelijke Hoogte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Verkoop Specificaties",
              "displayName": "Verkoop Specificaties",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Sales Review Notities",
              "displayName": "Sales Review Notities",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Binnenmaat (mm)",
              "displayName": "Breedte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Binnenmaat (mm)",
              "displayName": "Hoogte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Buitenmaat (mm)",
              "displayName": "Breedte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Buitenmaat (mm)",
              "displayName": "Hoogte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Peilmaat",
              "displayName": "Peilmaat",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Model Deur",
              "displayName": "Model Deur",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Draairichting",
              "displayName": "Draairichting",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Links binnendraaiend",
                  "value": "Links binnendraaiend"
                },
                {
                  "name": "Rechts binnendraaiend",
                  "value": "Rechts binnendraaiend"
                },
                {
                  "name": "Links buitendraaiend",
                  "value": "Links buitendraaiend"
                },
                {
                  "name": "Rechts buitendraaiend",
                  "value": "Rechts buitendraaiend"
                },
                {
                  "name": "Dubbeldeuren",
                  "value": "Dubbeldeuren"
                },
                {
                  "name": "Schuifdeur links",
                  "value": "Schuifdeur links"
                },
                {
                  "name": "Schuifdeur rechts",
                  "value": "Schuifdeur rechts"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Type Kozijn (Constructie)",
              "displayName": "Type Kozijn (Constructie)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Stomp",
                  "value": "Stomp"
                },
                {
                  "name": "Aanslag",
                  "value": "Aanslag"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Type Profiel",
              "displayName": "Type Profiel",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "HVL",
                  "value": "HVL"
                },
                {
                  "name": "Standaard",
                  "value": "Standaard"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Staafgreep Specificatie",
              "displayName": "Staafgreep Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Glas Deurvleugel",
              "displayName": "Glas Deurvleugel",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Melkglas",
                  "value": "Melkglas"
                },
                {
                  "name": "Helder glas",
                  "value": "Helder glas"
                },
                {
                  "name": "Gelaagd glas",
                  "value": "Gelaagd glas"
                },
                {
                  "name": "Geen glas",
                  "value": "Geen glas"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hardstenen Dorpel Specificatie",
              "displayName": "Hardstenen Dorpel Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Cilinder Type",
              "displayName": "Cilinder Type",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Sleutelcilinder",
                  "value": "Sleutelcilinder"
                },
                {
                  "name": "Elektronisch",
                  "value": "Elektronisch"
                },
                {
                  "name": "Geen",
                  "value": "Geen"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Cilinder Gelijksluitend",
              "displayName": "Cilinder Gelijksluitend",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Ja, nieuwe set",
                  "value": "Ja, nieuwe set"
                },
                {
                  "name": "Nee",
                  "value": "Nee"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Brievenbus",
              "displayName": "Brievenbus",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Ja",
                  "value": "Ja"
                },
                {
                  "name": "Nee",
                  "value": "Nee"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwatering",
              "displayName": "Afwatering",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Onderkant",
                  "value": "Onderkant"
                },
                {
                  "name": "Voorkant",
                  "value": "Voorkant"
                },
                {
                  "name": "N.v.t.",
                  "value": "N.v.t."
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Binnenafwerking Detail",
              "displayName": "Binnenafwerking Detail",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Kap 6",
                  "value": "Kap 6"
                },
                {
                  "name": "Kap 10",
                  "value": "Kap 10"
                },
                {
                  "name": "Overig",
                  "value": "Overig"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Beglazing",
              "displayName": "Afwijkende Beglazing",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Kleuren",
              "displayName": "Afwijkende Kleuren",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Gevelbekleding Specificatie",
              "displayName": "Gevelbekleding Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Montage Notities (Inmeter)",
              "displayName": "Montage Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkingen Notities (Inmeter)",
              "displayName": "Afwijkingen Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Inmeet Status",
              "displayName": "Inmeet Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Nog niet ingemeten",
                  "value": "Nog niet ingemeten"
                },
                {
                  "name": "Inmeten voltooid",
                  "value": "Inmeten voltooid"
                },
                {
                  "name": "Overleg nodig na inmeten",
                  "value": "Overleg nodig na inmeten"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Sales Element ID",
              "displayName": "Sales Element ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Sales Sync Status",
              "displayName": "Sales Sync Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Nog niet gesynchroniseerd",
                  "value": "Nog niet gesynchroniseerd"
                },
                {
                  "name": "Gesynchroniseerd",
                  "value": "Gesynchroniseerd"
                },
                {
                  "name": "Synchronisatie fout",
                  "value": "Synchronisatie fout"
                },
                {
                  "name": "Sales data gewijzigd",
                  "value": "Sales data gewijzigd"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Sales Sync Timestamp",
              "displayName": "Sales Sync Timestamp",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "dateTime",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Kleur Kozijn Binnen",
              "displayName": "Kleur Kozijn Binnen",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Kleur Kozijn Buiten",
              "displayName": "Kleur Kozijn Buiten",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Kleur Deurvleugel Binnen",
              "displayName": "Kleur Deurvleugel Binnen",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Kleur Deurvleugel Buiten",
              "displayName": "Kleur Deurvleugel Buiten",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Deurbeslag Buiten",
              "displayName": "Deurbeslag Buiten",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Deurbeslag Binnen",
              "displayName": "Deurbeslag Binnen",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Definitieve Element Prijs",
              "displayName": "Definitieve Element Prijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -256,
        -64
      ],
      "id": "203db104-b153-45d5-8c4b-70a9a32280f3",
      "name": "Airtable Deur Elementen",
      "credentials": {
        "airtableTokenApi": {
          "id": "ax9Wtoz0YZou3bVH",
          "name": "Airtable Personal Access Token STB-kozijnen Workspace"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "={{ $json.body.element.element_type.toLowerCase() }}",
                    "rightValue": "(raam|kozijn)",
                    "operator": {
                      "type": "string",
                      "operation": "regex"
                    },
                    "id": "e19ea8e8-9125-4d45-820a-38f28224bc7d"
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "dd74c542-e01f-4724-8944-b0076b291336",
                    "leftValue": "={{ $json.body.element.element_type.toLowerCase() }}",
                    "rightValue": "(rolluik|rolluiken)",
                    "operator": {
                      "type": "string",
                      "operation": "regex"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "528e8a95-6f02-4969-8115-864d0252674f",
                    "leftValue": "={{ $json.body.element.element_type.toLowerCase() }}",
                    "rightValue": "(dakraam|velux|keylite)",
                    "operator": {
                      "type": "string",
                      "operation": "regex"
                    }
                  }
                ],
                "combinator": "and"
              }
            },
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "id": "536ed197-5338-4df2-a7c9-6546dc1e38a9",
                    "leftValue": "={{ $json.body.element.element_type.toLowerCase() }}",
                    "rightValue": "gevelbekleding, rockpanel, vinyplus",
                    "operator": {
                      "type": "string",
                      "operation": "regex"
                    }
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        -480,
        416
      ],
      "id": "6c94fdda-5027-4efc-ae0c-74c859ae50eb",
      "name": "Switch",
      "alwaysOutputData": false
    },
    {
      "parameters": {
        "jsCode": "// Element type mapping logic\nconst elementData = $input.first().json.element;\nconst salesType = elementData.element_type;\n\nconst typeMapping = {\n    \"Achterdeur met borstwering\": \"Achterdeur\",\n    \"Voordeur\": \"Voordeur\", \n    \"Draaikiep raam\": \"Kozijn\",\n    \"Draaikiep met bovenlicht - vast raam\": \"Kozijn\",\n    \"Schuifpui 2-delig\": \"Schuifpui\",\n    \"Meerprijs schuifpui 2-delig\": \"Schuifpui\"\n};\n\nconst productionType = typeMapping[salesType] || \"Overig\";\n\nreturn {\n    json: {\n        ...$input.first().json,\n        production_element_type: productionType\n    }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -256,
        352
      ],
      "id": "a9330089-606e-4fe8-8744-7faa995c00a9",
      "name": "Code3"
    },
    {
      "parameters": {
        "jsCode": "// Element type mapping logic\nconst elementData = $input.first().json.element;\nconst salesType = elementData.element_type;\n\nconst typeMapping = {\n    \"Achterdeur met borstwering\": \"Achterdeur\",\n    \"Voordeur\": \"Voordeur\", \n    \"Draaikiep raam\": \"Kozijn\",\n    \"Draaikiep met bovenlicht - vast raam\": \"Kozijn\",\n    \"Schuifpui 2-delig\": \"Schuifpui\",\n    \"Meerprijs schuifpui 2-delig\": \"Schuifpui\"\n};\n\nconst productionType = typeMapping[salesType] || \"Overig\";\n\nreturn {\n    json: {\n        ...$input.first().json,\n        production_element_type: productionType\n    }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -256,
        544
      ],
      "id": "a52cbe70-cf11-4817-80a7-07a8f11989bf",
      "name": "Code4"
    },
    {
      "parameters": {
        "jsCode": "// Element type mapping logic\nconst elementData = $input.first().json.element;\nconst salesType = elementData.element_type;\n\nconst typeMapping = {\n    \"Achterdeur met borstwering\": \"Achterdeur\",\n    \"Voordeur\": \"Voordeur\", \n    \"Draaikiep raam\": \"Kozijn\",\n    \"Draaikiep met bovenlicht - vast raam\": \"Kozijn\",\n    \"Schuifpui 2-delig\": \"Schuifpui\",\n    \"Meerprijs schuifpui 2-delig\": \"Schuifpui\"\n};\n\nconst productionType = typeMapping[salesType] || \"Overig\";\n\nreturn {\n    json: {\n        ...$input.first().json,\n        production_element_type: productionType\n    }\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -256,
        736
      ],
      "id": "15bd9299-e306-48fa-a821-a11d30bc3d7a",
      "name": "Code5"
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "appoYgxrhYZP5MAVT",
          "mode": "list",
          "cachedResultName": "STB-Productie",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT"
        },
        "table": {
          "__rl": true,
          "value": "tblcKnVFXwv8et3cL",
          "mode": "list",
          "cachedResultName": "Deur Elementen",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT/tblcKnVFXwv8et3cL"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Oorspronkelijke Breedte (mm)": 0,
            "Oorspronkelijke Hoogte (mm)": 0,
            "Breedte Binnenmaat (mm)": 0,
            "Hoogte Binnenmaat (mm)": 0,
            "Breedte Buitenmaat (mm)": 0,
            "Hoogte Buitenmaat (mm)": 0,
            "Peilmaat": 0
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Opdrachtnummer",
              "displayName": "Opdrachtnummer",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Element ID (Merk)",
              "displayName": "Element ID (Merk)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Soort Deur",
              "displayName": "Soort Deur",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Plaats",
              "displayName": "Plaats",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Breedte (mm)",
              "displayName": "Oorspronkelijke Breedte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Hoogte (mm)",
              "displayName": "Oorspronkelijke Hoogte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Verkoop Specificaties",
              "displayName": "Verkoop Specificaties",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Sales Review Notities",
              "displayName": "Sales Review Notities",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Binnenmaat (mm)",
              "displayName": "Breedte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Binnenmaat (mm)",
              "displayName": "Hoogte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Buitenmaat (mm)",
              "displayName": "Breedte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Buitenmaat (mm)",
              "displayName": "Hoogte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Peilmaat",
              "displayName": "Peilmaat",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Model Deur",
              "displayName": "Model Deur",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Draairichting",
              "displayName": "Draairichting",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Links binnendraaiend",
                  "value": "Links binnendraaiend"
                },
                {
                  "name": "Rechts binnendraaiend",
                  "value": "Rechts binnendraaiend"
                },
                {
                  "name": "Links buitendraaiend",
                  "value": "Links buitendraaiend"
                },
                {
                  "name": "Rechts buitendraaiend",
                  "value": "Rechts buitendraaiend"
                },
                {
                  "name": "Dubbeldeuren",
                  "value": "Dubbeldeuren"
                },
                {
                  "name": "Schuifdeur links",
                  "value": "Schuifdeur links"
                },
                {
                  "name": "Schuifdeur rechts",
                  "value": "Schuifdeur rechts"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Type Kozijn (Constructie)",
              "displayName": "Type Kozijn (Constructie)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Stomp",
                  "value": "Stomp"
                },
                {
                  "name": "Aanslag",
                  "value": "Aanslag"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Type Profiel",
              "displayName": "Type Profiel",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "HVL",
                  "value": "HVL"
                },
                {
                  "name": "Standaard",
                  "value": "Standaard"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Staafgreep Specificatie",
              "displayName": "Staafgreep Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Glas Deurvleugel",
              "displayName": "Glas Deurvleugel",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Melkglas",
                  "value": "Melkglas"
                },
                {
                  "name": "Helder glas",
                  "value": "Helder glas"
                },
                {
                  "name": "Gelaagd glas",
                  "value": "Gelaagd glas"
                },
                {
                  "name": "Geen glas",
                  "value": "Geen glas"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hardstenen Dorpel Specificatie",
              "displayName": "Hardstenen Dorpel Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Cilinder Type",
              "displayName": "Cilinder Type",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Sleutelcilinder",
                  "value": "Sleutelcilinder"
                },
                {
                  "name": "Elektronisch",
                  "value": "Elektronisch"
                },
                {
                  "name": "Geen",
                  "value": "Geen"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Cilinder Gelijksluitend",
              "displayName": "Cilinder Gelijksluitend",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Ja, nieuwe set",
                  "value": "Ja, nieuwe set"
                },
                {
                  "name": "Nee",
                  "value": "Nee"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Brievenbus",
              "displayName": "Brievenbus",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Ja",
                  "value": "Ja"
                },
                {
                  "name": "Nee",
                  "value": "Nee"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwatering",
              "displayName": "Afwatering",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Onderkant",
                  "value": "Onderkant"
                },
                {
                  "name": "Voorkant",
                  "value": "Voorkant"
                },
                {
                  "name": "N.v.t.",
                  "value": "N.v.t."
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Binnenafwerking Detail",
              "displayName": "Binnenafwerking Detail",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Kap 6",
                  "value": "Kap 6"
                },
                {
                  "name": "Kap 10",
                  "value": "Kap 10"
                },
                {
                  "name": "Overig",
                  "value": "Overig"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Beglazing",
              "displayName": "Afwijkende Beglazing",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Kleuren",
              "displayName": "Afwijkende Kleuren",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Gevelbekleding Specificatie",
              "displayName": "Gevelbekleding Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Montage Notities (Inmeter)",
              "displayName": "Montage Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkingen Notities (Inmeter)",
              "displayName": "Afwijkingen Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Inmeet Status",
              "displayName": "Inmeet Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Nog niet ingemeten",
                  "value": "Nog niet ingemeten"
                },
                {
                  "name": "Inmeten voltooid",
                  "value": "Inmeten voltooid"
                },
                {
                  "name": "Overleg nodig na inmeten",
                  "value": "Overleg nodig na inmeten"
                }
              ],
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -32,
        352
      ],
      "id": "fedda198-f8e6-479f-8c1d-d1cc495eed8d",
      "name": "Airtable Rolluik Elementen",
      "credentials": {
        "airtableTokenApi": {
          "id": "ax9Wtoz0YZou3bVH",
          "name": "Airtable Personal Access Token STB-kozijnen Workspace"
        }
      }
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "appoYgxrhYZP5MAVT",
          "mode": "list",
          "cachedResultName": "STB-Productie",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT"
        },
        "table": {
          "__rl": true,
          "value": "tblcKnVFXwv8et3cL",
          "mode": "list",
          "cachedResultName": "Deur Elementen",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT/tblcKnVFXwv8et3cL"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Oorspronkelijke Breedte (mm)": 0,
            "Oorspronkelijke Hoogte (mm)": 0,
            "Breedte Binnenmaat (mm)": 0,
            "Hoogte Binnenmaat (mm)": 0,
            "Breedte Buitenmaat (mm)": 0,
            "Hoogte Buitenmaat (mm)": 0,
            "Peilmaat": 0
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Opdrachtnummer",
              "displayName": "Opdrachtnummer",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Element ID (Merk)",
              "displayName": "Element ID (Merk)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Soort Deur",
              "displayName": "Soort Deur",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Plaats",
              "displayName": "Plaats",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Breedte (mm)",
              "displayName": "Oorspronkelijke Breedte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Hoogte (mm)",
              "displayName": "Oorspronkelijke Hoogte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Verkoop Specificaties",
              "displayName": "Verkoop Specificaties",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Sales Review Notities",
              "displayName": "Sales Review Notities",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Binnenmaat (mm)",
              "displayName": "Breedte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Binnenmaat (mm)",
              "displayName": "Hoogte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Buitenmaat (mm)",
              "displayName": "Breedte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Buitenmaat (mm)",
              "displayName": "Hoogte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Peilmaat",
              "displayName": "Peilmaat",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Model Deur",
              "displayName": "Model Deur",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Draairichting",
              "displayName": "Draairichting",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Links binnendraaiend",
                  "value": "Links binnendraaiend"
                },
                {
                  "name": "Rechts binnendraaiend",
                  "value": "Rechts binnendraaiend"
                },
                {
                  "name": "Links buitendraaiend",
                  "value": "Links buitendraaiend"
                },
                {
                  "name": "Rechts buitendraaiend",
                  "value": "Rechts buitendraaiend"
                },
                {
                  "name": "Dubbeldeuren",
                  "value": "Dubbeldeuren"
                },
                {
                  "name": "Schuifdeur links",
                  "value": "Schuifdeur links"
                },
                {
                  "name": "Schuifdeur rechts",
                  "value": "Schuifdeur rechts"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Type Kozijn (Constructie)",
              "displayName": "Type Kozijn (Constructie)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Stomp",
                  "value": "Stomp"
                },
                {
                  "name": "Aanslag",
                  "value": "Aanslag"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Type Profiel",
              "displayName": "Type Profiel",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "HVL",
                  "value": "HVL"
                },
                {
                  "name": "Standaard",
                  "value": "Standaard"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Staafgreep Specificatie",
              "displayName": "Staafgreep Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Glas Deurvleugel",
              "displayName": "Glas Deurvleugel",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Melkglas",
                  "value": "Melkglas"
                },
                {
                  "name": "Helder glas",
                  "value": "Helder glas"
                },
                {
                  "name": "Gelaagd glas",
                  "value": "Gelaagd glas"
                },
                {
                  "name": "Geen glas",
                  "value": "Geen glas"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hardstenen Dorpel Specificatie",
              "displayName": "Hardstenen Dorpel Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Cilinder Type",
              "displayName": "Cilinder Type",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Sleutelcilinder",
                  "value": "Sleutelcilinder"
                },
                {
                  "name": "Elektronisch",
                  "value": "Elektronisch"
                },
                {
                  "name": "Geen",
                  "value": "Geen"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Cilinder Gelijksluitend",
              "displayName": "Cilinder Gelijksluitend",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Ja, nieuwe set",
                  "value": "Ja, nieuwe set"
                },
                {
                  "name": "Nee",
                  "value": "Nee"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Brievenbus",
              "displayName": "Brievenbus",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Ja",
                  "value": "Ja"
                },
                {
                  "name": "Nee",
                  "value": "Nee"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwatering",
              "displayName": "Afwatering",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Onderkant",
                  "value": "Onderkant"
                },
                {
                  "name": "Voorkant",
                  "value": "Voorkant"
                },
                {
                  "name": "N.v.t.",
                  "value": "N.v.t."
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Binnenafwerking Detail",
              "displayName": "Binnenafwerking Detail",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Kap 6",
                  "value": "Kap 6"
                },
                {
                  "name": "Kap 10",
                  "value": "Kap 10"
                },
                {
                  "name": "Overig",
                  "value": "Overig"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Beglazing",
              "displayName": "Afwijkende Beglazing",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Kleuren",
              "displayName": "Afwijkende Kleuren",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Gevelbekleding Specificatie",
              "displayName": "Gevelbekleding Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Montage Notities (Inmeter)",
              "displayName": "Montage Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkingen Notities (Inmeter)",
              "displayName": "Afwijkingen Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Inmeet Status",
              "displayName": "Inmeet Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Nog niet ingemeten",
                  "value": "Nog niet ingemeten"
                },
                {
                  "name": "Inmeten voltooid",
                  "value": "Inmeten voltooid"
                },
                {
                  "name": "Overleg nodig na inmeten",
                  "value": "Overleg nodig na inmeten"
                }
              ],
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -32,
        544
      ],
      "id": "64d81b25-3cbd-4b50-b38e-b34884bc6b3b",
      "name": "Airtable Dakraam Elementen",
      "credentials": {
        "airtableTokenApi": {
          "id": "ax9Wtoz0YZou3bVH",
          "name": "Airtable Personal Access Token STB-kozijnen Workspace"
        }
      }
    },
    {
      "parameters": {
        "operation": "create",
        "base": {
          "__rl": true,
          "value": "appoYgxrhYZP5MAVT",
          "mode": "list",
          "cachedResultName": "STB-Productie",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT"
        },
        "table": {
          "__rl": true,
          "value": "tblcKnVFXwv8et3cL",
          "mode": "list",
          "cachedResultName": "Deur Elementen",
          "cachedResultUrl": "https://airtable.com/appoYgxrhYZP5MAVT/tblcKnVFXwv8et3cL"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Oorspronkelijke Breedte (mm)": 0,
            "Oorspronkelijke Hoogte (mm)": 0,
            "Breedte Binnenmaat (mm)": 0,
            "Hoogte Binnenmaat (mm)": 0,
            "Breedte Buitenmaat (mm)": 0,
            "Hoogte Buitenmaat (mm)": 0,
            "Peilmaat": 0
          },
          "matchingColumns": [],
          "schema": [
            {
              "id": "Opdrachtnummer",
              "displayName": "Opdrachtnummer",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Element ID (Merk)",
              "displayName": "Element ID (Merk)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Soort Deur",
              "displayName": "Soort Deur",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Plaats",
              "displayName": "Plaats",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Breedte (mm)",
              "displayName": "Oorspronkelijke Breedte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Oorspronkelijke Hoogte (mm)",
              "displayName": "Oorspronkelijke Hoogte (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Verkoop Specificaties",
              "displayName": "Verkoop Specificaties",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Sales Review Notities",
              "displayName": "Sales Review Notities",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Binnenmaat (mm)",
              "displayName": "Breedte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Binnenmaat (mm)",
              "displayName": "Hoogte Binnenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Breedte Buitenmaat (mm)",
              "displayName": "Breedte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoogte Buitenmaat (mm)",
              "displayName": "Hoogte Buitenmaat (mm)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Peilmaat",
              "displayName": "Peilmaat",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Model Deur",
              "displayName": "Model Deur",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Draairichting",
              "displayName": "Draairichting",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Links binnendraaiend",
                  "value": "Links binnendraaiend"
                },
                {
                  "name": "Rechts binnendraaiend",
                  "value": "Rechts binnendraaiend"
                },
                {
                  "name": "Links buitendraaiend",
                  "value": "Links buitendraaiend"
                },
                {
                  "name": "Rechts buitendraaiend",
                  "value": "Rechts buitendraaiend"
                },
                {
                  "name": "Dubbeldeuren",
                  "value": "Dubbeldeuren"
                },
                {
                  "name": "Schuifdeur links",
                  "value": "Schuifdeur links"
                },
                {
                  "name": "Schuifdeur rechts",
                  "value": "Schuifdeur rechts"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Type Kozijn (Constructie)",
              "displayName": "Type Kozijn (Constructie)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Stomp",
                  "value": "Stomp"
                },
                {
                  "name": "Aanslag",
                  "value": "Aanslag"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Type Profiel",
              "displayName": "Type Profiel",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "HVL",
                  "value": "HVL"
                },
                {
                  "name": "Standaard",
                  "value": "Standaard"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Staafgreep Specificatie",
              "displayName": "Staafgreep Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Glas Deurvleugel",
              "displayName": "Glas Deurvleugel",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Melkglas",
                  "value": "Melkglas"
                },
                {
                  "name": "Helder glas",
                  "value": "Helder glas"
                },
                {
                  "name": "Gelaagd glas",
                  "value": "Gelaagd glas"
                },
                {
                  "name": "Geen glas",
                  "value": "Geen glas"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hardstenen Dorpel Specificatie",
              "displayName": "Hardstenen Dorpel Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Cilinder Type",
              "displayName": "Cilinder Type",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Sleutelcilinder",
                  "value": "Sleutelcilinder"
                },
                {
                  "name": "Elektronisch",
                  "value": "Elektronisch"
                },
                {
                  "name": "Geen",
                  "value": "Geen"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Cilinder Gelijksluitend",
              "displayName": "Cilinder Gelijksluitend",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Ja, nieuwe set",
                  "value": "Ja, nieuwe set"
                },
                {
                  "name": "Nee",
                  "value": "Nee"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Brievenbus",
              "displayName": "Brievenbus",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Ja",
                  "value": "Ja"
                },
                {
                  "name": "Nee",
                  "value": "Nee"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwatering",
              "displayName": "Afwatering",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Onderkant",
                  "value": "Onderkant"
                },
                {
                  "name": "Voorkant",
                  "value": "Voorkant"
                },
                {
                  "name": "N.v.t.",
                  "value": "N.v.t."
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Binnenafwerking Detail",
              "displayName": "Binnenafwerking Detail",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Kap 6",
                  "value": "Kap 6"
                },
                {
                  "name": "Kap 10",
                  "value": "Kap 10"
                },
                {
                  "name": "Overig",
                  "value": "Overig"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Beglazing",
              "displayName": "Afwijkende Beglazing",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkende Kleuren",
              "displayName": "Afwijkende Kleuren",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Gevelbekleding Specificatie",
              "displayName": "Gevelbekleding Specificatie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Montage Notities (Inmeter)",
              "displayName": "Montage Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Afwijkingen Notities (Inmeter)",
              "displayName": "Afwijkingen Notities (Inmeter)",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Inmeet Status",
              "displayName": "Inmeet Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Nog niet ingemeten",
                  "value": "Nog niet ingemeten"
                },
                {
                  "name": "Inmeten voltooid",
                  "value": "Inmeten voltooid"
                },
                {
                  "name": "Overleg nodig na inmeten",
                  "value": "Overleg nodig na inmeten"
                }
              ],
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        -32,
        736
      ],
      "id": "d25aca91-c0a3-41a4-9bf5-1578af768bf3",
      "name": "Airtable Gevelbekleding Elementen",
      "credentials": {
        "airtableTokenApi": {
          "id": "ax9Wtoz0YZou3bVH",
          "name": "Airtable Personal Access Token STB-kozijnen Workspace"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "deuren-review",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -704,
        -64
      ],
      "id": "082c60c3-61f1-43fb-81ad-1ad267252457",
      "name": "Deuren Controle Webhook",
      "webhookId": "1fb8d6fd-cab6-4f79-beac-b000cda75eff"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "factuur-trigger",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -704,
        -288
      ],
      "id": "414c2f83-29b2-406f-bf03-9e07fd0063bc",
      "name": "Facturen Webhook",
      "webhookId": "1fb8d6fd-cab6-4f79-beac-b000cda75eff"
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "elementen-review",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -704,
        448
      ],
      "id": "cf329c9e-3d23-4ab1-b682-14088b5352b7",
      "name": "Elementen Controle Webhook",
      "webhookId": "1fb8d6fd-cab6-4f79-beac-b000cda75eff"
    },
    {
      "parameters": {
        "operation": "upsert",
        "base": {
          "__rl": true,
          "value": "app9mz6mT0zk8XRGm",
          "mode": "list",
          "cachedResultName": "STB-Sales",
          "cachedResultUrl": "https://airtable.com/app9mz6mT0zk8XRGm"
        },
        "table": {
          "__rl": true,
          "value": "tblCRDWlFWm9DaG6c",
          "mode": "list",
          "cachedResultName": "Nacalculatie",
          "cachedResultUrl": "https://airtable.com/app9mz6mT0zk8XRGm/tblCRDWlFWm9DaG6c"
        },
        "columns": {
          "mappingMode": "defineBelow",
          "value": {
            "Element Breedte mm": "={{ $json.width_mm }}",
            "Element Hoogte mm": "={{ $json.height_mm }}",
            "Element Totaal Verkoop": 0,
            "Hoofdproduct Kostprijs": 0,
            "Totale Kostprijs": 0,
            "Bruto Marge": 0,
            "Marge Percentage": 0,
            "Subproduct 1 Verkoopprijs": 0,
            "Subproduct 1 Kostprijs": 0,
            "Subproduct 1 Marge": 0,
            "Subproduct 1 Marge Percentage": 0,
            "Subproduct 2 Verkoopprijs": 0,
            "Subproduct 2 Kostprijs": 0,
            "Subproduct 2 Marge": 0,
            "Subproduct 2 Marge Percentage": 0,
            "Subproduct 3 Verkoopprijs": 0,
            "Subproduct 3 Kostprijs": 0,
            "Subproduct 3 Marge": 0,
            "Subproduct 3 Marge Percentage": 0,
            "Subproduct 4 Verkoopprijs": 0,
            "Subproduct 4 Kostprijs": 0,
            "Subproduct 4 Marge": 0,
            "Subproduct 4 Marge Percentage": 0,
            "Subproduct 5 Verkoopprijs": 0,
            "Subproduct 5 Kostprijs": 0,
            "Subproduct 5 Marge": 0,
            "Subproduct 5 Marge Percentage": 0,
            "id": "={{ $json.request_id }}"
          },
          "matchingColumns": [
            "id"
          ],
          "schema": [
            {
              "id": "id",
              "displayName": "id",
              "required": false,
              "defaultMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Opdrachtnummer",
              "displayName": "Opdrachtnummer",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Nacalculatie ID",
              "displayName": "Nacalculatie ID",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Element ID Ref",
              "displayName": "Element ID Ref",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Klantnaam",
              "displayName": "Klantnaam",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": true
            },
            {
              "id": "Element Breedte mm",
              "displayName": "Element Breedte mm",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Element Hoogte mm",
              "displayName": "Element Hoogte mm",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Element Totaal Verkoop",
              "displayName": "Element Totaal Verkoop",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Totale Kostprijs",
              "displayName": "Totale Kostprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Bruto Marge",
              "displayName": "Bruto Marge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Marge Percentage",
              "displayName": "Marge Percentage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Marge Categorie",
              "displayName": "Marge Categorie",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Excellent (>25%)",
                  "value": "Excellent (>25%)"
                },
                {
                  "name": "Good (15-25%)",
                  "value": "Good (15-25%)"
                },
                {
                  "name": "Warning (10-15%)",
                  "value": "Warning (10-15%)"
                },
                {
                  "name": "Critical (<10%)",
                  "value": "Critical (<10%)"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Kostprijs Status",
              "displayName": "Kostprijs Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Volledig automatisch",
                  "value": "Volledig automatisch"
                },
                {
                  "name": "Gedeeltelijk handmatig",
                  "value": "Gedeeltelijk handmatig"
                },
                {
                  "name": "Volledig handmatig",
                  "value": "Volledig handmatig"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Validatie Status",
              "displayName": "Validatie Status",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "options",
              "options": [
                {
                  "name": "Te controleren",
                  "value": "Te controleren"
                },
                {
                  "name": "Gevalideerd",
                  "value": "Gevalideerd"
                },
                {
                  "name": "Afwijking gevonden",
                  "value": "Afwijking gevonden"
                }
              ],
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Notities",
              "displayName": "Notities",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoofdproduct Naam",
              "displayName": "Hoofdproduct Naam",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoofdproduct Kostprijs",
              "displayName": "Hoofdproduct Kostprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Hoofdproduct Marge",
              "displayName": "Hoofdproduct Marge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Hoofdproduct Marge Percentage",
              "displayName": "Hoofdproduct Marge Percentage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": true,
              "removed": false
            },
            {
              "id": "Subproduct 1 Naam",
              "displayName": "Subproduct 1 Naam",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 1 Verkoopprijs",
              "displayName": "Subproduct 1 Verkoopprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 1 Kostprijs",
              "displayName": "Subproduct 1 Kostprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 1 Marge",
              "displayName": "Subproduct 1 Marge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 1 Marge Percentage",
              "displayName": "Subproduct 1 Marge Percentage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 2 Naam",
              "displayName": "Subproduct 2 Naam",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 2 Verkoopprijs",
              "displayName": "Subproduct 2 Verkoopprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 2 Kostprijs",
              "displayName": "Subproduct 2 Kostprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 2 Marge",
              "displayName": "Subproduct 2 Marge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 2 Marge Percentage",
              "displayName": "Subproduct 2 Marge Percentage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 3 Naam",
              "displayName": "Subproduct 3 Naam",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 3 Verkoopprijs",
              "displayName": "Subproduct 3 Verkoopprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 3 Kostprijs",
              "displayName": "Subproduct 3 Kostprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 3 Marge",
              "displayName": "Subproduct 3 Marge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 3 Marge Percentage",
              "displayName": "Subproduct 3 Marge Percentage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 4 Naam",
              "displayName": "Subproduct 4 Naam",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 4 Verkoopprijs",
              "displayName": "Subproduct 4 Verkoopprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 4 Kostprijs",
              "displayName": "Subproduct 4 Kostprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 4 Marge",
              "displayName": "Subproduct 4 Marge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 4 Marge Percentage",
              "displayName": "Subproduct 4 Marge Percentage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 5 Naam",
              "displayName": "Subproduct 5 Naam",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "string",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 5 Verkoopprijs",
              "displayName": "Subproduct 5 Verkoopprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 5 Kostprijs",
              "displayName": "Subproduct 5 Kostprijs",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 5 Marge",
              "displayName": "Subproduct 5 Marge",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            },
            {
              "id": "Subproduct 5 Marge Percentage",
              "displayName": "Subproduct 5 Marge Percentage",
              "required": false,
              "defaultMatch": false,
              "canBeUsedToMatch": true,
              "display": true,
              "type": "number",
              "readOnly": false,
              "removed": false
            }
          ],
          "attemptToConvertTypes": false,
          "convertFieldsToString": false
        },
        "options": {}
      },
      "type": "n8n-nodes-base.airtable",
      "typeVersion": 2.1,
      "position": [
        176,
        1184
      ],
      "id": "46ac4368-0b1d-43b8-bcc2-6519113a0a82",
      "name": "Create or update a record",
      "credentials": {
        "airtableTokenApi": {
          "id": "ax9Wtoz0YZou3bVH",
          "name": "Airtable Personal Access Token STB-kozijnen Workspace"
        }
      }
    },
    {
      "parameters": {
        "operation": "URL/HTML to PDF",
        "convertType": "htmlToPDF",
        "html": "={{ $json.html }}",
        "advancedOptions": {
          "name": "={{ `Inmeetformulier ${$json.opdrachtnummer}` }}"
        }
      },
      "type": "n8n-nodes-pdfco.PDFco Api",
      "typeVersion": 1,
      "position": [
        0,
        960
      ],
      "id": "af6dc5b5-2d39-4a39-b547-a7ddce4dedac",
      "name": "PDFco Api",
      "credentials": {
        "pdfcoApi": {
          "id": "inwu1jLP4yrabrDA",
          "name": "PDF.co account"
        }
      }
    },
    {
      "parameters": {
        "jsCode": "// STB-Kozijnen professionele factuur generator voor N8N (MET factuurtitel)\nfunction generateInvoiceHTML(invoiceData) {\n  const formatCurrency = (amount) => {\n    const n = Number(amount) || 0;\n    return new Intl.NumberFormat('nl-NL', {\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2,\n    }).format(n);\n  };\n\n  const extractPercentage = (typeFactuur) => {\n    const match = (typeFactuur || '').match(/(\\d+)%/);\n    return match ? match[1] : '';\n  };\n\n  const percentage = extractPercentage(invoiceData.type_factuur);\n\n  const html = `<!DOCTYPE html>\n<html lang=\"nl\">\n<head>\n  <meta charset=\"UTF-8\" />\n  <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\"/>\n  <style>\n    :root{\n      --stb-red:#e20613;\n      --stb-red-dark:#b1050f;\n      --ink:#2d2d2d;\n      --muted:#4a5568;\n      --soft:#f8f9fa;\n    }\n    @page { size: A4; margin: 12mm 14mm; }\n    @media print { html, body { width: 210mm; } p, li { orphans: 3; widows: 3; } }\n    * { margin: 0; padding: 0; box-sizing: border-box; }\n    body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI','Helvetica Neue', Arial, sans-serif; background:#fff; color:var(--ink); line-height:1.5; }\n    .invoice-container { width: 100%; background:#fff; }\n    .avoid-break { break-inside: avoid; page-break-inside: avoid; -webkit-column-break-inside: avoid; }\n\n    /* Header */\n    .header-section { position: relative; background: linear-gradient(135deg, var(--stb-red) 0%, #ff5a66 50%, var(--stb-red-dark) 100%); padding:24px 28px; overflow:hidden; }\n    .header-section::before { content:''; position:absolute; top:-50%; right:-10%; width:50%; height:200%; background:rgba(0,0,0,.05); transform:rotate(35deg); }\n    .header-content { position:relative; z-index:2; display:flex; justify-content:space-between; align-items:center; }\n    .company-branding { display:flex; align-items:center; gap:16px; }\n    .logo-container { width:52px; height:52px; background:#fff; border-radius:12px; display:flex; align-items:center; justify-content:center; box-shadow:0 4px 15px rgba(0,0,0,.1); }\n    .logo-text { color:var(--stb-red); font-size:18px; font-weight:800; }\n    .company-name h1 { color:#fff; font-size:28px; font-weight:700; letter-spacing:-.3px; }\n    .company-name .tagline { color:rgba(255,255,255,.9); font-size:12px; font-style:italic; margin-top:2px; }\n    .invoice-badge { background:rgba(255,255,255,.2); backdrop-filter:blur(10px); padding:10px 20px; border-radius:999px; border:2px solid rgba(255,255,255,.3); }\n    .invoice-badge h2 { color:#fff; font-size:20px; font-weight:600; letter-spacing:2px; }\n\n    /* Meta (twee kolommen: factuurnummer + factuurdatum) */\n    .invoice-meta { background:var(--soft); padding:18px 28px; display:grid; grid-template-columns:repeat(2,1fr); gap:18px; border-bottom:3px solid var(--stb-red); }\n    .meta-block { text-align:center; }\n    .meta-block h3 { color:var(--stb-red); font-size:10px; font-weight:700; text-transform:uppercase; letter-spacing:1px; margin-bottom:6px; }\n    .meta-block p { color:var(--ink); font-size:14px; font-weight:600; }\n\n    /* Main */\n    .main-content { padding:24px 28px; display:grid; grid-template-columns:1fr 1fr; gap:24px; }\n    .client-card, .order-card { background:#fff; border:2px solid #f1f3f5; border-radius:16px; padding:20px; position:relative; overflow:hidden; }\n    .client-card::before { content:''; position:absolute; top:0; left:0; right:0; height:4px; background:linear-gradient(90deg, var(--stb-red), #ff5a66); }\n    .order-card::before  { content:''; position:absolute; top:0; left:0; right:0; height:4px; background:linear-gradient(90deg, #ff5a66, var(--stb-red)); }\n    .client-card h3, .order-card h3 { color:var(--ink); font-size:15px; font-weight:700; margin-bottom:12px; display:flex; align-items:center; gap:8px; }\n    .client-card h3::before { content:'👤'; font-size:18px; }\n    .order-card  h3::before { content:'📋'; font-size:18px; }\n    .client-info p { color:var(--muted); font-size:13px; margin:4px 0; }\n    .client-info .name { color:var(--ink); font-size:15px; font-weight:600; margin-bottom:8px; }\n    .order-details { display:grid; gap:8px; }\n    .order-row { display:flex; justify-content:space-between; padding:6px 0; border-bottom:1px solid #f1f3f5; }\n    .order-label { color:#718096; font-size:12px; font-weight:500; }\n    .order-value { color:var(--ink); font-size:13px; font-weight:600; text-align:right; }\n\n    /* Description */\n    .description-section { grid-column:1 / -1; background:linear-gradient(135deg,#ffe9ea 0%,#ffd6d9 100%); border-radius:16px; padding:18px; border-left:4px solid var(--stb-red); }\n    .description-title { color:var(--stb-red); font-size:16px; font-weight:700; margin-bottom:10px; }\n    .description-text { color:var(--muted); font-size:14px; line-height:1.6; }\n\n    /* Totals */\n    .totals-wrapper { grid-column:1 / -1; display:flex; justify-content:flex-end; margin-top:14px; }\n    .totals-box { width:440px; background:#fff; border:2px solid var(--stb-red); border-radius:16px; overflow:hidden; }\n    .totals-header { background:linear-gradient(135deg, var(--stb-red), #ff5a66); color:#fff; padding:12px 18px; font-size:15px; font-weight:700; text-transform:uppercase; letter-spacing:1px; }\n    .totals-content { padding:18px; }\n    .total-row { display:flex; justify-content:space-between; padding:8px 0; font-size:14px; }\n    .total-row.btw { color:#718096; }\n    .total-row.grand-total { border-top:2px solid var(--stb-red); padding-top:12px; margin-top:8px; font-size:18px; font-weight:700; color:var(--stb-red); }\n\n    /* Payment */\n    .payment-section { margin:20px 28px; background:#2d2d2d; color:#fff; border-radius:16px; padding:22px; position:relative; overflow:hidden; }\n    .payment-section::after { content:'💳'; position:absolute; right:24px; top:50%; transform:translateY(-50%); font-size:72px; opacity:.1; }\n    .payment-title { font-size:16px; font-weight:700; margin-bottom:16px; color:#fff; }\n    .payment-grid { display:grid; grid-template-columns:180px 1fr; gap:10px; position:relative; z-index:1; }\n    .payment-label { color:#a0a0a0; font-size:12px; font-weight:500; text-transform:uppercase; }\n    .payment-value { color:#fff; font-size:14px; font-weight:600; }\n    .payment-notice { margin-top:16px; padding-top:12px; border-top:1px solid rgba(255,255,255,.1); color:#a0a0a0; font-size:13px; }\n\n    /* Footer */\n    .footer { background:var(--soft); padding:20px 28px; border-top:3px solid var(--stb-red); }\n    .footer-content { display:grid; grid-template-columns:1fr 1fr 1fr; gap:18px; font-size:12px; color:var(--muted); }\n    .footer-block h4 { color:var(--stb-red); font-size:10px; font-weight:700; text-transform:uppercase; letter-spacing:.5px; margin-bottom:8px; }\n    .footer-block p { margin:2px 0; }\n  </style>\n</head>\n<body>\n  <div class=\"invoice-container\">\n    <!-- Header -->\n    <div class=\"header-section avoid-break\">\n      <div class=\"header-content\">\n        <div class=\"company-branding\">\n          <div class=\"logo-container\"><div class=\"logo-text\">STB</div></div>\n          <div class=\"company-name\">\n            <h1>STB-Kozijnen</h1>\n            <div class=\"tagline\">Meer dan alleen kozijnen</div>\n          </div>\n        </div>\n        <div class=\"invoice-badge\"><h2>FACTUUR</h2></div>\n      </div>\n    </div>\n\n    <!-- Invoice Meta -->\n    <div class=\"invoice-meta avoid-break\">\n      <div class=\"meta-block\">\n        <h3>FACTUURNUMMER</h3>\n        <p>${invoiceData.factuur_id || ''}</p>\n      </div>\n      <div class=\"meta-block\">\n        <h3>FACTUURDATUM</h3>\n        <p>${invoiceData.datum || ''}</p>\n      </div>\n    </div>\n\n    <!-- Main Content -->\n    <div class=\"main-content avoid-break\">\n      <!-- Client Card -->\n      <div class=\"client-card\">\n        <h3>Klantgegevens</h3>\n        <div class=\"client-info\">\n          <p class=\"name\">${invoiceData.klant_naam || ''}</p>\n          <p>${invoiceData.adres?.straat || ''}</p>\n          <p>${invoiceData.adres?.postcode || ''} ${invoiceData.adres?.plaats || ''}</p>\n          <p>📧 ${invoiceData.email || ''}</p>\n          <p>📞 ${invoiceData.telefoon || ''}</p>\n        </div>\n      </div>\n\n      <!-- Order Card -->\n      <div class=\"order-card\">\n        <h3>Ordergegevens</h3>\n        <div class=\"order-details\">\n          <div class=\"order-row\">\n            <span class=\"order-label\">Opdrachtnummer</span>\n            <span class=\"order-value\">${invoiceData.opdrachtnummer || ''}</span>\n          </div>\n          <div class=\"order-row\">\n            <span class=\"order-label\">Type factuur</span>\n            <span class=\"order-value\">${invoiceData.type_factuur || ''}</span>\n          </div>\n        </div>\n      </div>\n\n      <!-- Description - NU MET FACTUURTITEL -->\n      <div class=\"description-section avoid-break\">\n        <div class=\"description-title\">Betreft: ${invoiceData.type_factuur || 'Factuur'}</div>\n        <div class=\"description-text\">\n          ${invoiceData.factuurtitel ? `<strong>${invoiceData.factuurtitel}</strong><br><br>` : ''}\n          Het leveren en monteren van kunststof kozijnen / deuren en afwerkmaterialen<br>\n          Opdracht: <strong>${invoiceData.opdrachtnummer || ''}</strong>\n          ${\n            percentage\n              ? `<br><br>Dit betreft een ${percentage}% ${\n                  (invoiceData.type_factuur || '').includes('Vooraf') ? 'aanbetaling' : 'termijnfactuur'\n                } van de totale orderwaarde.`\n              : ''\n          }\n        </div>\n      </div>\n\n      <!-- Totals -->\n      <div class=\"totals-wrapper avoid-break\">\n        <div class=\"totals-box\">\n          <div class=\"totals-header\">Factuurtotalen</div>\n          <div class=\"totals-content\">\n            <div class=\"total-row\">\n              <span class=\"total-label\">Orderwaarde excl. BTW</span>\n              <span class=\"total-value\">€ ${formatCurrency(invoiceData.bedrag_excl_btw)}</span>\n            </div>\n            <div class=\"total-row btw\">\n              <span class=\"total-label\">BTW 21%</span>\n              <span class=\"total-value\">€ ${formatCurrency(invoiceData.btw_bedrag)}</span>\n            </div>\n            <div class=\"total-row grand-total\">\n              <span class=\"total-label\">Totaalbedrag</span>\n              <span class=\"total-value\">€ ${formatCurrency(invoiceData.bedrag)}</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n\n    <!-- Payment Section -->\n    <div class=\"payment-section avoid-break\">\n      <div class=\"payment-title\">Betalingsgegevens</div>\n      <div class=\"payment-grid\">\n        <div class=\"payment-label\">IBAN nummer</div>\n        <div class=\"payment-value\">NL73 INGB 0007 3122 15</div>\n        <div class=\"payment-label\">BIC nummer</div>\n        <div class=\"payment-value\">INGBNL2A</div>\n        <div class=\"payment-label\">Ten name van</div>\n        <div class=\"payment-value\">STB-Kozijnen B.V.</div>\n        <div class=\"payment-label\">Onder vermelding van</div>\n        <div class=\"payment-value\">${invoiceData.factuur_id || ''}</div>\n      </div>\n      <div class=\"payment-notice\">Wij verzoeken u vriendelijk deze factuur per ommegaande te voldoen.</div>\n    </div>\n\n    <!-- Footer -->\n    <div class=\"footer avoid-break\">\n      <div class=\"footer-content\">\n        <div class=\"footer-block\">\n          <h4>Vestiging Maasbree</h4>\n          <p>Groesweg 34a</p>\n          <p>5993NN Maasbree</p>\n          <p>info@stb-kozijnen.nl</p>\n        </div>\n        <div class=\"footer-block\">\n          <h4>Correspondentieadres</h4>\n          <p>Kaldenkerkerweg 20</p>\n          <p>5913AE Venlo</p>\n          <p>+31774 402 200</p>\n        </div>\n        <div class=\"footer-block\">\n          <h4>Bedrijfsgegevens</h4>\n          <p>KvK: 66362598</p>\n          <p>BTW: NL856513568B01</p>\n          <p>IBAN: NL73INGB0007312215</p>\n        </div>\n      </div>\n    </div>\n  </div>\n</body>\n</html>`;\n\n  return html;\n}\n\n// n8n: input -> html -> items array\nconst invoiceData = ($input && $input.first()) ? $input.first().json : {};\nconst htmlContent = generateInvoiceHTML(invoiceData);\n\nreturn [\n  {\n    json: {\n      html: htmlContent,\n      invoiceData,\n    },\n  },\n];"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -256,
        -288
      ],
      "id": "b59e176d-0f21-41ef-bc47-6963988d8ea5",
      "name": "HTML Generator"
    },
    {
      "parameters": {
        "operation": "URL/HTML to PDF",
        "convertType": "htmlToPDF",
        "html": "={{ $json.html }}",
        "advancedOptions": {
          "name": "={{ $json.invoiceData.factuur_id }}"
        }
      },
      "type": "n8n-nodes-pdfco.PDFco Api",
      "typeVersion": 1,
      "position": [
        -32,
        -288
      ],
      "id": "6ca2acf9-8a47-4016-91a0-5772593df362",
      "name": "PDFco Api1",
      "credentials": {
        "pdfcoApi": {
          "id": "inwu1jLP4yrabrDA",
          "name": "PDF.co account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "inmeetplanning",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -704,
        1408
      ],
      "id": "2bc45248-eae1-4d6f-9c4e-01042384b2ce",
      "name": "Inmeetplanning",
      "webhookId": "1fb8d6fd-cab6-4f79-beac-b000cda75eff"
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        192,
        -288
      ],
      "id": "7aff07fa-f96c-43b6-93ef-ad07be2f120a",
      "name": "HTTP Request"
    },
    {
      "parameters": {
        "sendTo": "info@stb-kozijnen.nl",
        "subject": "=Factuur {{ $('HTML Generator').item.json.invoiceData.factuur_id }} – STB-Kozijnen",
        "message": "=<div style=\"font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Helvetica Neue',Arial,sans-serif;color:#2d2d2d;line-height:1.55;\">\n  <p>Beste {{ $('Code').item.json.klant_naam || 'relatie' }},</p>\n\n  <p>In de bijlage vindt u <strong>factuur {{ $('Code').item.json.factuur_id }}</strong>\n  voor opdracht <strong>{{ $('Code').item.json.opdrachtnummer || '-' }}</strong>.</p>\n\n  <!-- Samenvatting (geen vervaldatum) -->\n  <table width=\"100%\" cellpadding=\"8\" cellspacing=\"0\" style=\"border-collapse:collapse;border:1px solid #eee;margin:12px 0;\">\n    <tr>\n      <td style=\"border:1px solid #eee;background:#fafafa;color:#e20613;font-weight:700;\">Factuurnummer</td>\n      <td style=\"border:1px solid #eee;\">{{ $('Code').item.json.factuur_id }}</td>\n    </tr>\n    <tr>\n      <td style=\"border:1px solid #eee;background:#fafafa;color:#e20613;font-weight:700;\">Factuurdatum</td>\n      <td style=\"border:1px solid #eee;\">{{ $('Code').item.json.datum }}</td>\n    </tr>\n    <tr>\n      <td style=\"border:1px solid #eee;\">Orderwaarde excl. BTW</td>\n      <td style=\"border:1px solid #eee;text-align:right;\">€ {{ $('Code').item.json.bedrag_excl_btw }}</td>\n    </tr>\n    <tr>\n      <td style=\"border:1px solid #eee;\">BTW {{ $('Code').item.json.btw_percentage || 21 }}%</td>\n      <td style=\"border:1px solid #eee;text-align:right;\">€ {{ $('Code').item.json.btw_bedrag }}</td>\n    </tr>\n    <tr>\n      <td style=\"border-top:2px solid #e20613;border-left:1px solid #eee;border-right:1px solid #eee;font-weight:700;color:#e20613;\">Totaal</td>\n      <td style=\"border-top:2px solid #e20613;border-left:1px solid #eee;border-right:1px solid #eee;text-align:right;font-weight:700;color:#e20613;\">\n        € {{ $('Code').item.json.bedrag }}\n      </td>\n    </tr>\n  </table>\n\n  <!-- Betaalgegevens -->\n  <div style=\"margin:16px 0; padding:12px; border:1px solid #eee; border-left:4px solid #e20613; background:#fafafa;\">\n    <div style=\"font-weight:700;margin-bottom:6px;\">Betaalgegevens</div>\n    <div>IBAN: <strong>NL73 INGB 0007 3122 15</strong> (STB-Kozijnen B.V.)</div>\n    <div>Onder vermelding van: <strong>{{ $('Code').item.json.factuur_id }}</strong></div>\n  </div>\n\n  <p>Alvast bedankt voor de betaling.</p>\n  <p>Met vriendelijke groet,<br/>STB-Kozijnen</p>\n</div>\n",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {}
            ]
          }
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        416,
        -288
      ],
      "id": "9180270b-18f6-4d59-a877-f03f82d61c07",
      "name": "Send a message",
      "webhookId": "33ef1092-c3f2-4ef4-b4e1-eeb1b689f755",
      "credentials": {
        "gmailOAuth2": {
          "id": "N5VAFdIcBqMdGTwR",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "nacalculatie",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -704,
        1184
      ],
      "id": "36587320-4ba6-4724-9094-f676f2c64443",
      "name": "Elementen Controle naar Nacalculatie",
      "webhookId": "1fb8d6fd-cab6-4f79-beac-b000cda75eff"
    },
    {
      "parameters": {
        "jsCode": "// n8n Code node (JavaScript) — clean agent payload (no debug, no computed VAT)\n\n// ===== Helpers =====\nconst br2nl = (s='') => s.replace(/<br\\s*\\/?>/gi, '\\n');\n\n// Strips tags, maar behoudt eerder geplaatste \\n (na br2nl)\nconst stripTagsKeepNl = (s='') => br2nl(s).replace(/<[^>]*>/g, '').replace(/\\u00A0/g,' ').replace(/[ \\t]+\\n/g, '\\n').trim();\n\n// Valuta parser met EU/US robuustheid\n// - bevat zowel '.' als ','  -> '.' = thousands, ',' = decimals\n// - alleen ','               -> ',' = decimals\n// - alleen '.'               -> '.' = decimals (enkele landen gebruiken ',' als thousands, maar dat komt hier niet voor)\nfunction parseEuro(str='') {\n  const raw = String(str).replace(/[^\\d.,\\-]/g, '').trim();\n  if (!raw) return null;\n\n  const hasDot = raw.includes('.');\n  const hasComma = raw.includes(',');\n\n  let norm = raw;\n\n  if (hasDot && hasComma) {\n    // 1.234,56\n    norm = raw.replace(/\\./g, '').replace(/,/g, '.');\n  } else if (hasComma && !hasDot) {\n    // 1234,56  of  1,234 (we nemen aan: , = decimals als er 2 decimals zijn)\n    if (/,(\\d{2})$/.test(raw)) norm = raw.replace(/,/g, '.');    // decimals\n    else norm = raw.replace(/,/g, '');                            // thousands\n  } else if (hasDot && !hasComma) {\n    // 1234.56  of  1.234  (als 3-digit groepjes gevolgd door geen decimal -> thousands)\n    if (/\\.\\d{3}(?:\\.|$)/.test(raw) && !/\\.\\d{2}$/.test(raw)) {\n      norm = raw.replace(/\\./g, '');\n    }\n  }\n\n  const n = parseFloat(norm);\n  return isNaN(n) ? null : n;\n}\n\n// \"1000mm x 2430mm\" -> {width_mm, height_mm, area_m2}\nfunction parseDims(s='') {\n  const m = String(s).match(/(\\d+)\\s*mm\\s*x\\s*(\\d+)\\s*mm/i);\n  if (!m) return { width_mm:null, height_mm:null, area_m2:null };\n  const w = parseInt(m[1],10);\n  const h = parseInt(m[2],10);\n  return { width_mm:w, height_mm:h, area_m2: +( (w*h)/1_000_000 ).toFixed(3) };\n}\n\n// Split in elementen: op de grijze divider (of fallback op herhaald label)\nfunction splitElements(html) {\n  const divider = /<span[^>]*background-color\\s*:\\s*#999[^>]*>\\s*<\\/span>/i;\n  const parts = html.split(divider).map(s=>s.trim()).filter(Boolean);\n  if (parts.length > 1) return parts;\n  const rough = html.split(/(?=<b>\\s*Opdrachtnummer\\s*<\\/b>)/i).map(s=>s.trim()).filter(Boolean);\n  return rough.length ? rough : [html];\n}\n\n// Label→waarde: eindig vóór volgende <b>Label</b> of einde\nfunction extractLabelMap(html) {\n  const map = {};\n  const re = /<b>([^<]+)<\\/b>\\s*<br\\/>([\\s\\S]*?)(?=(?:<b>[^<]+<\\/b>)|$)/gi;\n  let m;\n  while ((m = re.exec(html)) !== null) {\n    const label = m[1].replace(/\\s+/g,' ').trim();\n    // behoud \\n tussen regels zodat line items goed parsen\n    const value = stripTagsKeepNl(m[2]).replace(/\\n{3,}/g, '\\n\\n').trim();\n    map[label] = value;\n  }\n  return map;\n}\n\n// \"Naam: 1x €123 = €123\"\nfunction parseLineItems(text='') {\n  const items = [];\n  const lines = String(text).split(/\\r?\\n/).map(s=>s.trim()).filter(Boolean);\n  const re = /^(.*?):\\s*(\\d+)x\\s*€?\\s*([\\-]?\\d[\\d.,]*)\\s*=\\s*€?\\s*([\\-]?\\d[\\d.,]*)$/i;\n  for (const line of lines) {\n    const m = line.match(re);\n    if (!m) continue;\n    items.push({\n      name: m[1].trim(),\n      qty: parseInt(m[2],10),\n      unit_price: parseEuro(m[3]),\n      total: parseEuro(m[4]),\n    });\n  }\n  return items;\n}\n\nfunction sum(arr=[]) { return +(arr.reduce((a,b)=>a+(b||0),0).toFixed(2)); }\n\n// ===== Main =====\nconst html = String(items[0].json?.body?.viewId || '').trim();\nif (!html) {\n  return [{ json: { meta:{ elements_count:0, source_key:'body.viewId (empty)' }, totals:{ hoofdproduct_total:0, korting_total:0, overige_posten_total:0, net_subtotal:0, btw_total_given:0, gross_total_given:0 }, elements:[] } }];\n}\n\nconst blocks = splitElements(html);\n\n// Parse elk element\nconst elements = blocks.map(block => {\n  const info = extractLabelMap(block);\n\n  const lineItems = parseLineItems(info['Alle Regelitems Detail'] || '');\n\n  // Segmenten\n  const seg = { hoofdproduct_total:0, korting_total:0, overige_posten_total:0 };\n  for (const li of lineItems) {\n    const name = li.name.toLowerCase();\n    if (name.includes('korting')) seg.korting_total += li.total || 0;\n    else if (name.includes('overige posten')) seg.overige_posten_total += li.total || 0;\n    else seg.hoofdproduct_total += li.total || 0;\n  }\n  const subtotal = +( (seg.hoofdproduct_total + seg.korting_total + seg.overige_posten_total).toFixed(2) );\n\n  // Dimensies\n  const dims = parseDims(info['Geoffreerde Afmetingen'] || '');\n  const width_mm  = parseInt(info['Breedte (mm)'] || '', 10) || dims.width_mm || null;\n  const height_mm = parseInt(info['Hoogte (mm)']  || '', 10) || dims.height_mm || null;\n  const area_m2   = (width_mm && height_mm) ? +( (width_mm*height_mm)/1_000_000 ).toFixed(3) : (dims.area_m2 ?? null);\n\n  // Meegegeven bedragen (geen eigen BTW-berekening!)\n  const element_btw_given   = parseEuro(info['Element BTW'] || '');\n  const total_incl_given    = parseEuro(info['Element Totaal Incl BTW'] || '');\n\n  return {\n    opdrachtnummer: (info['Opdrachtnummer'] || '').trim(),\n    element_id_ref: (info['Element ID Ref'] || '').trim(),\n    element_id: (info['Element ID'] || '').trim(),\n    klantnaam: (info['Klantnaam'] || '').trim(),\n    element_type: (info['Element Type'] || '').trim(),\n    locatie: (info['Locatie'] || '').trim(),\n    afmetingen_str: (info['Geoffreerde Afmetingen'] || '').trim(),\n    width_mm, height_mm, area_m2,\n    hoofdproduct: (info['Hoofdproduct'] || '').trim(),\n    hoofdproduct_groep: stripTagsKeepNl(info['Hoofdproduct Groep'] || '').trim(),\n    verkoop_review_status: stripTagsKeepNl(info['Verkoop Review Status'] || '').trim(),\n    pricing: {\n      line_items: lineItems,                 // [{name, qty, unit_price, total}]\n      segments: seg,                         // {hoofdproduct_total, korting_total, overige_posten_total}\n      subtotal: subtotal,                    // herberekend op basis van line items\n      element_btw: element_btw_given ?? 0,   // zoals aangeleverd\n      total_incl: total_incl_given ?? (subtotal + (element_btw_given || 0)) // liefst aangeleverd; fallback optioneel\n    }\n  };\n});\n\n// Project totals (zonder eigen VAT-berekening)\nconst totals = (() => {\n  const hoofd = sum(elements.map(e => e.pricing.segments.hoofdproduct_total));\n  const kort  = sum(elements.map(e => e.pricing.segments.korting_total));\n  const over  = sum(elements.map(e => e.pricing.segments.overige_posten_total));\n  const net   = sum(elements.map(e => e.pricing.subtotal));\n  const btw   = sum(elements.map(e => e.pricing.element_btw));\n  const gross = sum(elements.map(e => e.pricing.total_incl));\n  return {\n    hoofdproduct_total: hoofd,\n    korting_total: kort,\n    overige_posten_total: over,\n    net_subtotal: net,\n    btw_total_given: btw,\n    gross_total_given: gross\n  };\n})();\n\nreturn [{\n  json: {\n    meta: { elements_count: elements.length, source_key: 'body.viewId' },\n    totals,\n    elements\n  }\n}];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -480,
        1184
      ],
      "id": "9c5363ae-983c-47dc-ba8f-701b4f6859d4",
      "name": "Code7"
    },
    {
      "parameters": {
        "operation": "URL/HTML to PDF",
        "convertType": "htmlToPDF",
        "html": "={{ $json.json.html }}",
        "advancedOptions": {
          "name": "=Inmeetplanning_{{ $json.datum_groep.datum_key }}"
        }
      },
      "type": "n8n-nodes-pdfco.PDFco Api",
      "typeVersion": 1,
      "position": [
        816,
        1408
      ],
      "id": "71ccf5e2-0d1c-4544-9e3d-42e7a18ab849",
      "name": "PDFco Api2",
      "credentials": {
        "pdfcoApi": {
          "id": "inwu1jLP4yrabrDA",
          "name": "PDF.co account"
        }
      }
    },
    {
      "parameters": {
        "url": "={{ $json.url }}",
        "options": {
          "response": {
            "response": {
              "responseFormat": "file"
            }
          }
        }
      },
      "type": "n8n-nodes-base.httpRequest",
      "typeVersion": 4.2,
      "position": [
        1008,
        1408
      ],
      "id": "8aa9c432-2e58-4e1a-843e-cb8a2a95d3b0",
      "name": "HTTP Request1"
    },
    {
      "parameters": {
        "fieldToSplitOut": "elements",
        "options": {}
      },
      "type": "n8n-nodes-base.splitOut",
      "typeVersion": 1,
      "position": [
        -256,
        1184
      ],
      "id": "3d465a5f-54f3-47b7-8687-4a136ab2bb90",
      "name": "Split Out"
    },
    {
      "parameters": {
        "operation": "executeQuery",
        "query": "SELECT \n  product_code,\n  product_name,\n  min_width_mm,\n  max_width_mm,\n  min_height_mm,\n  max_height_mm,\n  COALESCE(supplier_cost, 0) as inkoop_price,\n  currency,\n  last_price_update\nFROM price_lookup \nWHERE product_code = '{{ $json.hoofdproduct_groep }}'\n  AND {{ $json.width_mm }} >= min_width_mm \n  AND {{ $json.width_mm }} <= max_width_mm\n  AND {{ $json.height_mm }} >= min_height_mm \n  AND {{ $json.height_mm }} <= max_height_mm;",
        "options": {}
      },
      "type": "n8n-nodes-base.postgres",
      "typeVersion": 2.6,
      "position": [
        -48,
        1184
      ],
      "id": "a9aa3db7-f05e-4315-bee0-59281d98f6bc",
      "name": "Execute a SQL query",
      "credentials": {
        "postgres": {
          "id": "ayOvm0H5XtxGVqf3",
          "name": "Neon_STB-kozijnen"
        }
      }
    },
    {
      "parameters": {
        "httpMethod": "POST",
        "path": "nacalculatie",
        "options": {}
      },
      "type": "n8n-nodes-base.webhook",
      "typeVersion": 2,
      "position": [
        -704,
        960
      ],
      "id": "cc385306-dd54-45e2-be52-ec2c38b0fc8f",
      "name": "Elementen Controle naar Nacalculatie1",
      "webhookId": "1fb8d6fd-cab6-4f79-beac-b000cda75eff"
    },
    {
      "parameters": {
        "jsCode": "/**\n * STB Kozijnen PDF Generator - Production Ready\n * Genereert professionele inmeetformulieren exact zoals handmatig voorbeeld\n */\n\nclass STBPDFGenerator {\n  constructor(data) {\n    this.orderNumber = data.orderNumber || '';\n    this.customer = data.customer || {};\n    this.elements = data.elements || [];\n    this.globalOptions = data.globalOptions || {};\n  }\n\n  /**\n   * Hoofdfunctie die complete PDF genereert\n   */\n  generatePDF() {\n    const pages = [];\n    \n    // 1. Voorblad\n    pages.push(this.generateCoverPage());\n    \n    // 2. Overzichtspagina met specificaties\n    pages.push(this.generateOverviewPage());\n    \n    // 3. Kleurspecificatie tabel (alleen voor kozijnen, niet deuren)\n    if (this.hasColorSpecs()) {\n      pages.push(this.generateColorSpecPage());\n    }\n    \n    // 4. Groepeer elementen per verdieping voor tekenbladen\n    const elementsByFloor = this.groupElementsByFloor();\n    \n    // 5. Per verdieping: tekenblad + elementen\n    Object.keys(elementsByFloor).forEach(floor => {\n      // Tekenblad voor deze verdieping\n      pages.push(this.generateFloorSketchPage(floor, elementsByFloor[floor]));\n      \n      // Elementen voor deze verdieping\n      elementsByFloor[floor].forEach(element => {\n        const elementPages = this.generateElementPages(element);\n        pages.push(...elementPages);\n      });\n    });\n    \n    // 6. Handtekening pagina\n    pages.push(this.generateSignaturePage());\n    \n    return this.wrapInHTML(pages);\n  }\n\n  /**\n   * Groepeer elementen per verdieping\n   */\n  groupElementsByFloor() {\n    const floors = {};\n    this.elements.forEach((element, index) => {\n      element.code = String.fromCharCode(65 + index); // A, B, C, etc.\n      const floor = this.getFloor(element.location);\n      if (!floors[floor]) {\n        floors[floor] = [];\n      }\n      floors[floor].push(element);\n    });\n    return floors;\n  }\n\n  /**\n   * Bepaal verdieping uit locatie\n   */\n  getFloor(location) {\n    const loc = (location || '').toLowerCase();\n    if (loc.includes('eerste verdieping')) return 'Eerste verdieping';\n    if (loc.includes('tweede verdieping')) return 'Tweede verdieping';\n    if (loc.includes('zolder')) return 'Zolder';\n    return 'Begane grond';\n  }\n\n  /**\n   * Voorblad\n   */\n  generateCoverPage() {\n    return `\n      <div class=\"page cover-page\">\n        <div class=\"header-block\">\n          <div class=\"logo-section\">\n            <div class=\"logo\">STB</div>\n            <div class=\"company-name\">STB-Kozijnen</div>\n          </div>\n          <div class=\"order-info\">\n            <h1>INMEETFORMULIER</h1>\n            <h2>${this.orderNumber}</h2>\n          </div>\n        </div>\n        \n        <div class=\"customer-block\">\n          <h3>Klantgegevens</h3>\n          <table class=\"info-table\">\n            <tr><td>Naam:</td><td>${this.customer.name || ''}</td></tr>\n            <tr><td>Adres:</td><td>${this.customer.address || ''}</td></tr>\n            <tr><td>Postcode:</td><td>${this.customer.postcode || ''}</td></tr>\n            <tr><td>Plaats:</td><td>${this.customer.city || ''}</td></tr>\n            <tr><td>Telefoon:</td><td>${this.customer.phone || ''}</td></tr>\n            <tr><td>E-mail:</td><td>${this.customer.email || ''}</td></tr>\n          </table>\n        </div>\n        \n        <div class=\"date-section\">\n          <p>Inmeetdatum: ${new Date().toLocaleDateString('nl-NL')}</p>\n          <p>Inmeter: ______________________</p>\n        </div>\n      </div>\n    `;\n  }\n\n  /**\n   * Overzichtspagina\n   */\n  generateOverviewPage() {\n    const elementCodes = this.elements.map((_, i) => String.fromCharCode(65 + i)).join(', ');\n    \n    return `\n      <div class=\"page\">\n        <div class=\"section-header\">Technische specificatie</div>\n        \n        <table class=\"spec-table\">\n          <tr>\n            <td>Profielstijl</td>\n            <td>Verdiept, met houtlookverbinding</td>\n          </tr>\n          <tr>\n            <td>Beglazing</td>\n            <td>Hoog rendement isolatieglas HR+++ triple glas</td>\n          </tr>\n          <tr>\n            <td>Afstandhouders</td>\n            <td>Aluminium</td>\n          </tr>\n        </table>\n        \n        <div class=\"section-header\">Uit te voeren werkzaamheden</div>\n        \n        <table class=\"work-table\">\n          <tr>\n            <td>☑ Demonteren</td>\n            <td>${elementCodes}</td>\n          </tr>\n          <tr>\n            <td>☑ Monteren</td>\n            <td>${elementCodes}</td>\n          </tr>\n          <tr>\n            <td>☐ Binnenafwerking</td>\n            <td>-</td>\n          </tr>\n          <tr>\n            <td>☑ Buitenafwerking</td>\n            <td>${elementCodes}</td>\n          </tr>\n          <tr>\n            <td>☑ Afvoer oude materialen</td>\n            <td>${elementCodes}</td>\n          </tr>\n        </table>\n        \n        <div class=\"section-header\">Opties</div>\n        ${this.generateOptionsOverview()}\n      </div>\n    `;\n  }\n\n  /**\n   * Genereer opties overzicht\n   */\n  generateOptionsOverview() {\n    const optionsList = {\n      'HR+++ triple glas': [],\n      'Houtlookverbinding (HVL)': [],\n      'Horren': [],\n      'Hardstenen waterslagen slim': [],\n      'Hardstenen onderdorpels': [],\n      'Veiligheidsglas': [],\n      'Plisséhordeur': [],\n      'Gelijksluitende cilinder': []\n    };\n    \n    // Verzamel welke elementen welke opties hebben\n    this.elements.forEach((element, index) => {\n      const code = String.fromCharCode(65 + index);\n      if (element.options?.hrGlas !== false) optionsList['HR+++ triple glas'].push(code);\n      if (element.options?.houtlookverbinding !== false) optionsList['Houtlookverbinding (HVL)'].push(code);\n      if (element.options?.hor) optionsList['Horren'].push(code);\n      if (element.options?.waterslagen) optionsList['Hardstenen waterslagen slim'].push(code);\n      if (element.options?.hardstenenOnderdorpel) optionsList['Hardstenen onderdorpels'].push(code);\n      if (element.options?.veiligheidsglas) optionsList['Veiligheidsglas'].push(code);\n      if (element.options?.plissehordeur) optionsList['Plisséhordeur'].push(code);\n      if (element.options?.gelijksluitendeCilinder) optionsList['Gelijksluitende cilinder'].push(code);\n    });\n    \n    let html = '<div class=\"options-list\">';\n    Object.keys(optionsList).forEach(option => {\n      if (optionsList[option].length > 0) {\n        html += `\n          <div class=\"option-row\">\n            <span>☑ ${option}</span>\n            <span>${optionsList[option].join(', ')}</span>\n          </div>\n        `;\n      }\n    });\n    html += '</div>';\n    \n    return html;\n  }\n\n  /**\n   * Kleurspecificatie pagina\n   */\n  generateColorSpecPage() {\n    return `\n      <div class=\"page\">\n        <div class=\"section-header\">Kleurspecificatie</div>\n        \n        <table class=\"color-table\">\n          <thead>\n            <tr>\n              <th>Specificatie</th>\n              <th>Kleur</th>\n              <th>Massa/Nerf/Zand</th>\n              <th>Nr.</th>\n            </tr>\n          </thead>\n          <tbody>\n            <tr>\n              <td>Kozijn binnen</td>\n              <td>Wit</td>\n              <td>Houtnerfstructuur</td>\n              <td>AP44</td>\n            </tr>\n            <tr>\n              <td>Vleugels binnen</td>\n              <td>Wit</td>\n              <td>Houtnerfstructuur</td>\n              <td>AP44</td>\n            </tr>\n            <tr>\n              <td>Kozijn buiten</td>\n              <td>Wit</td>\n              <td>Houtnerfstructuur</td>\n              <td>AP44</td>\n            </tr>\n            <tr>\n              <td>Vleugels buiten</td>\n              <td>Wit</td>\n              <td>Houtnerfstructuur</td>\n              <td>AP44</td>\n            </tr>\n            <tr>\n              <td>Binnenafwerking</td>\n              <td>-</td>\n              <td>-</td>\n              <td>-</td>\n            </tr>\n          </tbody>\n        </table>\n        \n        <p class=\"note\">LET OP: Dit is de kleur voor de kozijnen. Voor kleur deuren, zie specificatie deuren.</p>\n      </div>\n    `;\n  }\n\n  /**\n   * Tekenblad per verdieping\n   */\n  generateFloorSketchPage(floor, elements) {\n    const elementCodes = elements.map(e => e.code).join(', ');\n    \n    return `\n      <div class=\"page sketch-page\">\n        <div class=\"sketch-header\">\n          <h3>Tekenblad - ${floor}</h3>\n          <p>Elementen: ${elementCodes}</p>\n        </div>\n        \n        <div class=\"sketch-grid\"></div>\n        \n        <div class=\"sketch-footer\">\n          <p>Voorgevel / Achtergevel / Zijgevel</p>\n          <p class=\"note\">Wijzigingen door: ______________________</p>\n        </div>\n      </div>\n    `;\n  }\n\n  /**\n   * Element pagina's\n   */\n  generateElementPages(element) {\n    const pages = [];\n    const elementType = this.getElementType(element);\n    \n    // Hoofdpagina element\n    pages.push(this.generateElementMainPage(element, elementType));\n    \n    // Extra specs voor deuren\n    if (elementType === 'door') {\n      pages.push(this.generateDoorSpecPage(element));\n    }\n    \n    // Extra specs voor schuifpui\n    if (elementType === 'sliding') {\n      pages.push(this.generateSlidingSpecPage(element));\n    }\n    \n    return pages;\n  }\n\n  /**\n   * Element hoofdpagina\n   */\n  generateElementMainPage(element, elementType) {\n    return `\n      <div class=\"page\">\n        <div class=\"element-header\">\n          <div class=\"element-code\">${element.code}</div>\n          <div class=\"element-info\">\n            <h3>${element.type || 'Raam'}</h3>\n          </div>\n        </div>\n        \n        <table class=\"element-spec-table\">\n          <tr>\n            <td>Maat B x H*</td>\n            <td>${element.width || 0}x${element.height || 0}mm</td>\n          </tr>\n          <tr>\n            <td>Plaats</td>\n            <td>${element.location || ''}</td>\n          </tr>\n        </table>\n        \n        <div class=\"section-header\">Inmeetformulier</div>\n        \n        <div class=\"measurement-grid\">\n          <div class=\"measurement-row\">\n            <span>Type profiel</span>\n            <span class=\"input-line\">Verdiept HVL</span>\n          </div>\n          <div class=\"measurement-row\">\n            <span>Type kozijn</span>\n            <span class=\"checkbox-group\">\n              <label>☐ Stomp</label>\n              <label>☐ Aanslag</label>\n            </span>\n          </div>\n        </div>\n        \n        <div class=\"measurement-fields\">\n          <div class=\"field-row\">\n            <div class=\"field\">\n              <label>Breedte buiten*</label>\n              <span class=\"input-line\"></span>\n            </div>\n            <div class=\"field\">\n              <label>Breedte binnen*</label>\n              <span class=\"input-line\"></span>\n            </div>\n          </div>\n          <div class=\"field-row\">\n            <div class=\"field\">\n              <label>Hoogte buiten*</label>\n              <span class=\"input-line\"></span>\n            </div>\n            <div class=\"field\">\n              <label>Hoogte binnen*</label>\n              <span class=\"input-line\"></span>\n            </div>\n          </div>\n        </div>\n        \n        <div class=\"section-header\">In begrepen</div>\n        ${this.generateElementOptions(element)}\n        \n        <div class=\"signature-section\">\n          <p>Handtekening voor akkoord</p>\n          <div class=\"signature-box\"></div>\n        </div>\n      </div>\n    `;\n  }\n\n  /**\n   * Element opties\n   */\n  generateElementOptions(element) {\n    const options = [];\n    \n    if (element.options?.hor) {\n      options.push(`☑ Hor ${element.options.horType || 'Klemhor'}`);\n    }\n    if (element.options?.hardstenenOnderdorpel) {\n      options.push('☑ Hardstenen onderdorpel');\n    }\n    if (element.options?.hrGlas !== false) {\n      options.push('☑ HR+++ glas');\n    }\n    if (element.options?.houtlookverbinding !== false) {\n      options.push('☑ Houtlookverbinding (HVL)');\n    }\n    \n    return `<div class=\"options-check\">${options.join('<br>')}</div>`;\n  }\n\n  /**\n   * Deur specificaties\n   */\n  generateDoorSpecPage(element) {\n    return `\n      <div class=\"page\">\n        <div class=\"element-header\">\n          <div class=\"element-code\">${element.code}</div>\n          <div>Deur specificaties</div>\n        </div>\n        \n        <table class=\"spec-table\">\n          <thead>\n            <tr><th colspan=\"2\">Specificatie - Kleur</th></tr>\n          </thead>\n          <tbody>\n            <tr><td>Kozijn binnen</td><td>Wit met houtnerfstructuur (AP44)</td></tr>\n            <tr><td>Vleugel binnen</td><td>Wit met houtnerfstructuur (AP44)</td></tr>\n            <tr><td>Kozijn buiten</td><td>Wit met houtnerfstructuur (AP44)</td></tr>\n            <tr><td>Vleugel buiten</td><td>Wit met houtnerfstructuur (AP44)</td></tr>\n            <tr><td>Borstwering</td><td>Wit met houtnerfstructuur (AP44)</td></tr>\n            <tr><td>Deurbeslag binnen</td><td>Zwart</td></tr>\n            <tr><td>Deurbeslag buiten</td><td>Zwart</td></tr>\n            <tr><td>Scharnieren buiten</td><td>Wit</td></tr>\n          </tbody>\n        </table>\n        \n        <table class=\"spec-table\">\n          <thead>\n            <tr><th colspan=\"2\">Specificatie - Type</th></tr>\n          </thead>\n          <tbody>\n            <tr><td>Borstwering deur</td><td>Sandwich paneel</td></tr>\n            <tr><td>Glas deurvleugel</td><td>Helder</td></tr>\n            <tr><td>Glas zijlicht</td><td>Helder</td></tr>\n            <tr><td>Glas bovenlicht</td><td>N.v.t</td></tr>\n            <tr><td>Soort dorpel</td><td>Hardstenen onderdorpel</td></tr>\n            <tr><td>Type cilinder</td><td>Standaard sleutel cilinder</td></tr>\n            <tr><td>Cilinder gelijksluitend</td><td>Ja, nieuwe set (regelt STB-kozijnen)</td></tr>\n            <tr><td>Draairichting</td><td>Wordt met inmeten bepaald</td></tr>\n          </tbody>\n        </table>\n      </div>\n    `;\n  }\n\n  /**\n   * Schuifpui specificaties\n   */\n  generateSlidingSpecPage(element) {\n    return `\n      <div class=\"page\">\n        <div class=\"element-header\">\n          <div class=\"element-code\">${element.code}</div>\n          <div>Schuifpui specificaties</div>\n        </div>\n        \n        <table class=\"spec-table\">\n          <thead>\n            <tr><th colspan=\"2\">Specificatie - Kleur</th></tr>\n          </thead>\n          <tbody>\n            <tr><td>Kozijn binnen</td><td>Wit met houtnerfstructuur (AP44)</td></tr>\n            <tr><td>Vleugel binnen</td><td>Wit met houtnerfstructuur (AP44)</td></tr>\n            <tr><td>Kozijn buiten</td><td>Wit met houtnerfstructuur (AP44)</td></tr>\n            <tr><td>Vleugel buiten</td><td>Wit met houtnerfstructuur (AP44)</td></tr>\n            <tr><td>Deurbeslag binnen</td><td>Zwart</td></tr>\n            <tr><td>Deurbeslag buiten</td><td>Zwart</td></tr>\n          </tbody>\n        </table>\n        \n        <table class=\"spec-table\">\n          <thead>\n            <tr><th colspan=\"2\">Specificatie - Type</th></tr>\n          </thead>\n          <tbody>\n            <tr><td>Glas deurvleugel</td><td>Helder, enkelzijdig veiligheidsglas</td></tr>\n            <tr><td>Glas zijlicht</td><td>N.v.t</td></tr>\n            <tr><td>Glas bovenlicht</td><td>N.v.t</td></tr>\n            <tr><td>Soort dorpel</td><td>Hardstenen onderdorpel</td></tr>\n            <tr><td>Type cilinder</td><td>Standaard sleutel cilinder</td></tr>\n            <tr><td>Van buiten afsluitbaar</td><td>Nee</td></tr>\n            <tr><td>Cilinder gelijksluitend</td><td>Ja, nieuwe set (regelt STB-kozijnen)</td></tr>\n            <tr><td>Schuifrichting</td><td>Wordt met inmeten bepaald</td></tr>\n          </tbody>\n        </table>\n      </div>\n    `;\n  }\n\n  /**\n   * Handtekening pagina\n   */\n  generateSignaturePage() {\n    return `\n      <div class=\"page signature-page\">\n        <div class=\"section-header\">Akkoordverklaring</div>\n        \n        <div class=\"agreement-text\">\n          <p>Ondergetekende verklaart dat alle maten correct zijn ingemeten en dat de specificaties zoals hierboven vermeld correct zijn.</p>\n          <p>Na ondertekening kunnen geen wijzigingen meer worden doorgevoerd zonder meerkosten.</p>\n        </div>\n        \n        <div class=\"signature-grid\">\n          <div class=\"signature-block\">\n            <p><strong>Inmeter</strong></p>\n            <div class=\"signature-box\"></div>\n            <p>Naam: ______________________</p>\n            <p>Datum: ${new Date().toLocaleDateString('nl-NL')}</p>\n          </div>\n          \n          <div class=\"signature-block\">\n            <p><strong>Klant</strong></p>\n            <div class=\"signature-box\"></div>\n            <p>Naam: ${this.customer.name || '______________________'}</p>\n            <p>Datum: ______________________</p>\n          </div>\n        </div>\n      </div>\n    `;\n  }\n\n  /**\n   * Helpers\n   */\n  getElementType(element) {\n    const type = (element.type || '').toLowerCase();\n    if (type.includes('deur')) return 'door';\n    if (type.includes('schuif')) return 'sliding';\n    if (type.includes('dakraam')) return 'skylight';\n    return 'window';\n  }\n\n  hasColorSpecs() {\n    return true; // Altijd tonen voor consistentie\n  }\n\n  /**\n   * HTML wrapper met styles\n   */\n  wrapInHTML(pages) {\n    return `\n      <!DOCTYPE html>\n      <html lang=\"nl\">\n      <head>\n        <meta charset=\"UTF-8\">\n        <title>Inmeetformulier ${this.orderNumber}</title>\n        <style>${this.getStyles()}</style>\n      </head>\n      <body>\n        ${pages.join('')}\n      </body>\n      </html>\n    `;\n  }\n\n  /**\n   * Complete stylesheet\n   */\n  getStyles() {\n    return `\n      * {\n        margin: 0;\n        padding: 0;\n        box-sizing: border-box;\n      }\n      \n      body {\n        font-family: Arial, sans-serif;\n        font-size: 11pt;\n        line-height: 1.4;\n        color: #333;\n      }\n      \n      .page {\n        width: 210mm;\n        min-height: 297mm;\n        padding: 15mm;\n        margin: 0 auto;\n        background: white;\n        page-break-after: always;\n      }\n      \n      /* Header */\n      .header-block {\n        display: flex;\n        justify-content: space-between;\n        margin-bottom: 30mm;\n        padding-bottom: 10mm;\n        border-bottom: 3px solid #E30613;\n      }\n      \n      .logo-section {\n        display: flex;\n        align-items: center;\n        gap: 10px;\n      }\n      \n      .logo {\n        width: 60px;\n        height: 60px;\n        background: #E30613;\n        color: white;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-weight: bold;\n        font-size: 24pt;\n        border-radius: 5px;\n      }\n      \n      .company-name {\n        font-size: 18pt;\n        font-weight: bold;\n        color: #E30613;\n      }\n      \n      .order-info h1 {\n        font-size: 20pt;\n        color: #E30613;\n        margin-bottom: 5mm;\n      }\n      \n      .order-info h2 {\n        font-size: 16pt;\n        color: #333;\n      }\n      \n      /* Section headers */\n      .section-header {\n        background: #E30613;\n        color: white;\n        padding: 5mm;\n        margin: 10mm 0 5mm 0;\n        font-weight: bold;\n        font-size: 12pt;\n      }\n      \n      /* Tables */\n      .info-table,\n      .spec-table,\n      .work-table,\n      .element-spec-table {\n        width: 100%;\n        border-collapse: collapse;\n        margin: 10mm 0;\n      }\n      \n      .info-table td,\n      .spec-table td,\n      .work-table td {\n        padding: 3mm;\n        border-bottom: 1px solid #ddd;\n      }\n      \n      .info-table td:first-child,\n      .spec-table td:first-child,\n      .work-table td:first-child {\n        width: 40%;\n        font-weight: bold;\n      }\n      \n      .color-table {\n        width: 100%;\n        border-collapse: collapse;\n        margin: 10mm 0;\n      }\n      \n      .color-table th {\n        background: #E30613;\n        color: white;\n        padding: 4mm;\n        text-align: left;\n      }\n      \n      .color-table td {\n        padding: 4mm;\n        border: 1px solid #ddd;\n      }\n      \n      /* Element pages */\n      .element-header {\n        display: flex;\n        align-items: center;\n        gap: 20mm;\n        margin-bottom: 10mm;\n        padding-bottom: 5mm;\n        border-bottom: 2px solid #E30613;\n      }\n      \n      .element-code {\n        width: 50px;\n        height: 50px;\n        background: #E30613;\n        color: white;\n        display: flex;\n        align-items: center;\n        justify-content: center;\n        font-size: 24pt;\n        font-weight: bold;\n        border-radius: 5px;\n      }\n      \n      /* Measurement form tabel layout */\n      .measurement-form {\n        margin: 10mm 0;\n      }\n      \n      .measurement-table {\n        width: 100%;\n        border-collapse: collapse;\n        margin: 5mm 0;\n      }\n      \n      .measurement-table td {\n        padding: 3mm;\n        vertical-align: middle;\n      }\n      \n      .label-cell {\n        width: 25%;\n        font-weight: bold;\n      }\n      \n      .input-cell {\n        width: 25%;\n      }\n      \n      .divider-line {\n        border-bottom: 1px solid #333;\n        margin: 5mm 0;\n      }\n      \n      .input-line {\n        border: none;\n        border-bottom: 1px solid #333;\n        display: inline-block;\n        width: 80%;\n        margin: 0 2mm;\n      }\n      \n      .input-line-long {\n        border: none;\n        border-bottom: 1px solid #333;\n        display: inline-block;\n        width: 90%;\n        margin: 0 2mm;\n      }\n      \n      /* Oude measurement styles verwijderen/updaten */\n      .measurement-grid {\n        margin: 10mm 0;\n      }\n      \n      .measurement-row {\n        display: flex;\n        align-items: center;\n        margin: 5mm 0;\n        gap: 10mm;\n      }\n      \n      .measurement-row > span:first-child {\n        width: 40mm;\n      }\n      \n      .checkbox-group {\n        display: flex;\n        gap: 15mm;\n      }\n      \n      .field-row {\n        display: flex;\n        gap: 20mm;\n        margin: 8mm 0;\n      }\n      \n      .field {\n        flex: 1;\n      }\n      \n      .field label {\n        display: inline-block;\n        width: 35mm;\n      }\n      \n      /* Options */\n      .options-list {\n        margin: 10mm 0;\n      }\n      \n      .option-row {\n        display: flex;\n        justify-content: space-between;\n        padding: 2mm 0;\n        border-bottom: 1px solid #eee;\n      }\n      \n      .options-check {\n        margin: 5mm 0;\n        line-height: 2;\n      }\n      \n      /* Sketch page */\n      .sketch-grid {\n        height: 200mm;\n        background-image: \n          repeating-linear-gradient(#ddd 0 1px, transparent 1px 100%),\n          repeating-linear-gradient(90deg, #ddd 0 1px, transparent 1px 100%);\n        background-size: 10mm 10mm;\n        border: 2px solid #333;\n        margin: 10mm 0;\n      }\n      \n      .sketch-header h3 {\n        font-size: 14pt;\n        color: #E30613;\n        margin-bottom: 3mm;\n      }\n      \n      .sketch-footer {\n        text-align: center;\n        margin-top: 10mm;\n      }\n      \n      /* Signature */\n      .signature-section {\n        margin-top: 20mm;\n        padding-top: 10mm;\n        border-top: 1px solid #ddd;\n      }\n      \n      .signature-box {\n        width: 100%;\n        height: 30mm;\n        border: 1px solid #999;\n        margin: 10mm 0;\n      }\n      \n      .signature-grid {\n        display: grid;\n        grid-template-columns: 1fr 1fr;\n        gap: 20mm;\n        margin-top: 20mm;\n      }\n      \n      .signature-block {\n        text-align: center;\n      }\n      \n      .signature-block .signature-box {\n        height: 40mm;\n      }\n      \n      /* Misc */\n      .note {\n        font-style: italic;\n        color: #666;\n        margin: 5mm 0;\n      }\n      \n      @media print {\n        .page {\n          margin: 0;\n          page-break-after: always;\n        }\n      }\n    `;\n  }\n}\n\n// Parser voor Airtable HTML input\nfunction parseAirtableHTML(htmlString) {\n  const extractValue = (html, label) => {\n    const regex = new RegExp(`<b>${label}</b><br/>([^<]*)`);\n    const match = html.match(regex);\n    return match ? match[1].trim() : '';\n  };\n  \n  const elements = htmlString.split('<span style=\"display:inline-block;height:1px;width:100%;background-color:#999\">').filter(e => e.trim());\n  \n  const parsedElements = elements.map(elementHtml => {\n    const width = extractValue(elementHtml, 'Breedte \\\\(mm\\\\)');\n    const height = extractValue(elementHtml, 'Hoogte \\\\(mm\\\\)');\n    const type = extractValue(elementHtml, 'Element Type');\n    const location = extractValue(elementHtml, 'Locatie');\n    \n    const options = {};\n    if (elementHtml.includes('Hardstenen raamdorpel')) options.hardstenenOnderdorpel = true;\n    if (elementHtml.includes('Insectenhor')) options.hor = true;\n    \n    return {\n      type,\n      width: parseInt(width) || 0,\n      height: parseInt(height) || 0,\n      location,\n      options\n    };\n  });\n  \n  const customerName = extractValue(elements[0], 'Klantnaam');\n  const orderNumber = extractValue(elements[0], 'Opdrachtnummer').split(' ')[0];\n  \n  return {\n    orderNumber,\n    customer: {\n      name: customerName,\n      address: '',\n      postcode: '',\n      city: '',\n      phone: '',\n      email: ''\n    },\n    elements: parsedElements\n  };\n}\n\n// N8N Entry Point\nconst inputData = $input.first().json;\nlet pdfData;\n\n// Check input type\nif (inputData.body && inputData.body.viewId) {\n  // Airtable HTML\n  pdfData = parseAirtableHTML(inputData.body.viewId);\n} else if (inputData.orderNumber) {\n  // Direct JSON\n  pdfData = inputData;\n} else {\n  // Fallback test data\n  pdfData = {\n    orderNumber: '1325081RK',\n    customer: {\n      name: 'Jay Shamal',\n      address: '',\n      postcode: '',\n      city: '',\n      phone: '',\n      email: ''\n    },\n    elements: [\n      {\n        type: '1/3 Draaikiep - 2/3 vast raam met bovenlichten inclusief',\n        width: 3000,\n        height: 600,\n        location: 'Begane grond zijgevel',\n        options: {\n          hardstenenOnderdorpel: true,\n          hor: true\n        }\n      },\n      {\n        type: '1/3 Draaikiep - 2/3 vast raam met bovenlichten inclusief',\n        width: 3000,\n        height: 600,\n        location: 'Begane grond zijgevel',\n        options: {\n          hardstenenOnderdorpel: true,\n          hor: true\n        }\n      },\n      {\n        type: 'Draaikiep - vast raam - draaikiep raam met bovenlichten',\n        width: 4000,\n        height: 600,\n        location: 'Begane grond zijgevel',\n        options: {}\n      }\n    ]\n  };\n}\n\n// Genereer PDF\nconst generator = new STBPDFGenerator(pdfData);\nconst html = generator.generatePDF();\n\n// Return output\nreturn {\n  html: html,\n  orderNumber: pdfData.orderNumber,\n  elementCount: pdfData.elements.length\n};"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -192,
        960
      ],
      "id": "e3ff57ba-9f8c-4b05-b9a9-927564c30aea",
      "name": "HTML Generator 2.0"
    },
    {
      "parameters": {
        "code": "// STB-Kozijnen Inmeetplanning Generator - Finale versie\nconst BEDRIJF_ADRES = \"Groesweg 34A, 5993NN Maasbree\";\nconst WERKDAG_START = 8;\nconst WERKDAG_EIND = 17;\nconst PAUZE_DUUR = 45;\n\n// Nederlandse postcode coordinaten mapping (uitgebreid voor hele regio)\nconst POSTCODE_COORDS = {\n    // Venlo regio\n    '5991': { lat: 51.3497, lng: 6.0877 }, // Baarlo\n    '5993': { lat: 51.3543, lng: 6.0420 }, // Maasbree\n    '5951': { lat: 51.3667, lng: 6.1333 }, // Belfeld\n    '5912': { lat: 51.3833, lng: 6.1667 }, // Venlo Noord\n    '5913': { lat: 51.3750, lng: 6.1683 }, // Venlo\n    '5914': { lat: 51.3700, lng: 6.1700 }, // Venlo\n    '5915': { lat: 51.3650, lng: 6.1717 }, // Venlo\n    '5916': { lat: 51.3500, lng: 6.1833 }, // Venlo Zuid\n    '5921': { lat: 51.3600, lng: 6.1750 }, // Blerick\n    '5922': { lat: 51.3650, lng: 6.1600 }, // Blerick\n    '5923': { lat: 51.3700, lng: 6.1550 }, // Blerick\n    '5924': { lat: 51.3750, lng: 6.1500 }, // Blerick\n    '5925': { lat: 51.3800, lng: 6.1450 }, // Blerick\n    '5926': { lat: 51.3850, lng: 6.1400 }, // Blerick\n    '5927': { lat: 51.3900, lng: 6.1350 }, // Blerick\n    '5928': { lat: 51.3950, lng: 6.1300 }, // Blerick\n    '5931': { lat: 51.3583, lng: 6.1417 }, // Tegelen\n    '5932': { lat: 51.3433, lng: 6.1383 }, // Tegelen\n    '5941': { lat: 51.4017, lng: 6.1750 }, // Velden\n    '5943': { lat: 51.4083, lng: 6.1667 }, // Lomm\n    '5961': { lat: 51.4417, lng: 6.0583 }, // Horst\n    '5962': { lat: 51.4483, lng: 6.0517 }, // Melderslo\n    '5963': { lat: 51.4550, lng: 6.0450 }, // Hegelsom\n    '5971': { lat: 51.4783, lng: 6.1000 }, // Grubbenvorst\n    '5973': { lat: 51.4850, lng: 6.1083 }, // Lottum\n    '5975': { lat: 51.5217, lng: 6.0133 }, // Sevenum\n    '5976': { lat: 51.5283, lng: 6.0200 }, // Kronenberg\n    '5981': { lat: 51.5000, lng: 5.9333 }, // Panningen\n    '5985': { lat: 51.4667, lng: 5.9500 }, // Grashoek\n    '5986': { lat: 51.4583, lng: 5.9583 }, // Beringe\n    '5987': { lat: 51.4500, lng: 5.9667 }, // Egchel\n    '5988': { lat: 51.4417, lng: 5.9750 }, // Helden\n    \n    // Roermond regio\n    '6041': { lat: 51.1931, lng: 5.9875 }, // Roermond centrum\n    '6042': { lat: 51.1875, lng: 5.9792 }, // Roermond\n    '6043': { lat: 51.1819, lng: 5.9708 }, // Roermond\n    '6044': { lat: 51.1764, lng: 5.9625 }, // Roermond\n    '6045': { lat: 51.1903, lng: 6.0042 }, // Roermond\n    \n    // Weert regio\n    '6001': { lat: 51.2517, lng: 5.7067 }, // Weert\n    '6002': { lat: 51.2450, lng: 5.6983 }, // Weert\n    '6003': { lat: 51.2383, lng: 5.6900 }, // Weert\n    '6004': { lat: 51.2317, lng: 5.6817 }, // Weert\n    '6005': { lat: 51.2250, lng: 5.6733 }, // Weert\n    '6006': { lat: 51.2467, lng: 5.7150 }, // Weert\n    \n    // Eindhoven regio\n    '5611': { lat: 51.4381, lng: 5.4778 }, // Eindhoven centrum\n    '5612': { lat: 51.4450, lng: 5.4850 }, // Eindhoven\n    '5613': { lat: 51.4517, lng: 5.4917 }, // Eindhoven\n    '5614': { lat: 51.4583, lng: 5.4983 }, // Eindhoven\n    '5615': { lat: 51.4417, lng: 5.4583 }, // Eindhoven\n    '5616': { lat: 51.4350, lng: 5.4517 }, // Eindhoven\n    '5617': { lat: 51.4283, lng: 5.4450 }, // Eindhoven\n    \n    // Helmond regio\n    '5701': { lat: 51.4750, lng: 5.6583 }, // Helmond centrum\n    '5702': { lat: 51.4817, lng: 5.6650 }, // Helmond\n    '5703': { lat: 51.4883, lng: 5.6717 }, // Helmond\n    '5704': { lat: 51.4950, lng: 5.6783 }, // Helmond\n    '5705': { lat: 51.4683, lng: 5.6517 }, // Helmond\n    \n    // Nijmegen regio\n    '6500': { lat: 51.8426, lng: 5.8545 }, // Nijmegen centrum\n    '6501': { lat: 51.8483, lng: 5.8600 }, // Nijmegen\n    '6511': { lat: 51.8450, lng: 5.8667 }, // Nijmegen\n    '6512': { lat: 51.8417, lng: 5.8733 }, // Nijmegen\n    '6521': { lat: 51.8383, lng: 5.8583 }, // Nijmegen\n    '6522': { lat: 51.8350, lng: 5.8517 }, // Nijmegen\n    '6523': { lat: 51.8317, lng: 5.8450 }, // Nijmegen\n    '6524': { lat: 51.8283, lng: 5.8383 }, // Nijmegen\n    '6525': { lat: 51.8250, lng: 5.8317 }, // Nijmegen\n    \n    // Default voor onbekende postcodes\n    'default': { lat: 51.3704, lng: 6.1724 }\n};\n\n// Rond af naar kwartieren\nfunction roundToQuarter(minutes) {\n    const hours = Math.floor(minutes / 60);\n    const mins = minutes % 60;\n    \n    // Rond minuten af naar dichtstbijzijnde kwartier\n    let roundedMins;\n    if (mins <= 7) roundedMins = 0;\n    else if (mins <= 22) roundedMins = 15;\n    else if (mins <= 37) roundedMins = 30;\n    else if (mins <= 52) roundedMins = 45;\n    else {\n        // Rond naar volgende uur\n        return roundToQuarter((hours + 1) * 60);\n    }\n    \n    const totalMinutes = hours * 60 + roundedMins;\n    \n    // Format output\n    if (totalMinutes === 0) return \"0 min\";\n    if (totalMinutes < 60) return `${totalMinutes} min`;\n    \n    const finalHours = Math.floor(totalMinutes / 60);\n    const finalMins = totalMinutes % 60;\n    \n    if (finalMins === 0) {\n        return finalHours === 1 ? \"1 uur\" : `${finalHours} uur`;\n    }\n    \n    return `${finalHours} uur ${finalMins} min`;\n}\n\n// Haal coordinaten voor postcode\nfunction getCoordinatesForPostcode(postcode) {\n    if (!postcode) return POSTCODE_COORDS['default'];\n    \n    const pc4 = postcode.substring(0, 4);\n    return POSTCODE_COORDS[pc4] || POSTCODE_COORDS['default'];\n}\n\n// Bereken afstand tussen twee punten (Haversine)\nfunction calculateDistance(lat1, lon1, lat2, lon2) {\n    const R = 6371;\n    const dLat = (lat2 - lat1) * Math.PI / 180;\n    const dLon = (lon2 - lon1) * Math.PI / 180;\n    const a = \n        Math.sin(dLat/2) * Math.sin(dLat/2) +\n        Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *\n        Math.sin(dLon/2) * Math.sin(dLon/2);\n    const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n    return R * c;\n}\n\n// 2-opt algoritme voor route verbetering\nfunction twoOptImprovement(route, distanceMatrix) {\n    let improved = true;\n    let bestRoute = [...route];\n    let bestDistance = calculateRouteDistance(bestRoute, distanceMatrix);\n    \n    while (improved) {\n        improved = false;\n        \n        for (let i = 1; i < bestRoute.length - 2; i++) {\n            for (let j = i + 1; j < bestRoute.length - 1; j++) {\n                const newRoute = [...bestRoute];\n                newRoute.splice(i, j - i + 1, ...bestRoute.slice(i, j + 1).reverse());\n                \n                const newDistance = calculateRouteDistance(newRoute, distanceMatrix);\n                \n                if (newDistance < bestDistance) {\n                    bestRoute = newRoute;\n                    bestDistance = newDistance;\n                    improved = true;\n                }\n            }\n        }\n    }\n    \n    return bestRoute;\n}\n\n// Bereken totale route afstand\nfunction calculateRouteDistance(route, distanceMatrix) {\n    let total = 0;\n    for (let i = 0; i < route.length - 1; i++) {\n        total += distanceMatrix[route[i]][route[i + 1]];\n    }\n    return total;\n}\n\n// TSP solver met 2-opt optimalisatie\nfunction solveTSP(opdrachten) {\n    const n = opdrachten.length + 1;\n    \n    const bedrijfsCoords = getCoordinatesForPostcode('5993');\n    \n    const locations = [\n        bedrijfsCoords,\n        ...opdrachten.map(op => {\n            const coords = getCoordinatesForPostcode(op.postcode_cijfers);\n            op.lat = coords.lat;\n            op.lng = coords.lng;\n            return coords;\n        })\n    ];\n    \n    const distanceMatrix = [];\n    for (let i = 0; i < n; i++) {\n        distanceMatrix[i] = [];\n        for (let j = 0; j < n; j++) {\n            if (i === j) {\n                distanceMatrix[i][j] = 0;\n            } else {\n                distanceMatrix[i][j] = calculateDistance(\n                    locations[i].lat, locations[i].lng,\n                    locations[j].lat, locations[j].lng\n                );\n            }\n        }\n    }\n    \n    const visited = new Array(n).fill(false);\n    const route = [0];\n    visited[0] = true;\n    let current = 0;\n    \n    for (let step = 1; step < n - 1; step++) {\n        let nearest = -1;\n        let minDist = Infinity;\n        \n        for (let j = 1; j < n; j++) {\n            if (!visited[j] && distanceMatrix[current][j] < minDist) {\n                minDist = distanceMatrix[current][j];\n                nearest = j;\n            }\n        }\n        \n        if (nearest !== -1) {\n            route.push(nearest);\n            visited[nearest] = true;\n            current = nearest;\n        }\n    }\n    \n    route.push(0);\n    \n    const optimizedRoute = twoOptImprovement(route, distanceMatrix);\n    \n    const opdrachtenRoute = optimizedRoute\n        .slice(1, -1)\n        .map(idx => opdrachten[idx - 1]);\n    \n    for (let i = 0; i < opdrachtenRoute.length; i++) {\n        const fromIdx = i === 0 ? 0 : optimizedRoute[i];\n        const toIdx = optimizedRoute[i + 1];\n        const afstand = distanceMatrix[fromIdx][toIdx];\n        opdrachtenRoute[i].reistijd_minuten = Math.round(afstand * 2);\n        opdrachtenRoute[i].afstand_km = afstand.toFixed(1);\n    }\n    \n    return opdrachtenRoute;\n}\n\n// Bereken tijdschema\nfunction calculateSchedule(opdrachten) {\n    let currentTime = WERKDAG_START * 60;\n    const schedule = [];\n    let pauseIngepland = false;\n    \n    opdrachten.forEach((opdracht, idx) => {\n        if (opdracht.reistijd_minuten) {\n            currentTime += opdracht.reistijd_minuten;\n        } else if (idx > 0) {\n            currentTime += 15;\n        }\n        \n        if (!pauseIngepland && currentTime >= 11.5 * 60 && currentTime <= 13 * 60) {\n            schedule.push({\n                isPauze: true,\n                start_tijd: '12:00',\n                eind_tijd: '12:45'\n            });\n            currentTime = Math.max(currentTime, 12 * 60) + PAUZE_DUUR;\n            pauseIngepland = true;\n        }\n        \n        const startMinutes = currentTime;\n        const endMinutes = currentTime + opdracht.duur_minuten;\n        \n        schedule.push({\n            ...opdracht,\n            start_tijd: `${Math.floor(startMinutes / 60).toString().padStart(2, '0')}:${(startMinutes % 60).toString().padStart(2, '0')}`,\n            eind_tijd: `${Math.floor(endMinutes / 60).toString().padStart(2, '0')}:${(endMinutes % 60).toString().padStart(2, '0')}`\n        });\n        \n        currentTime = endMinutes;\n    });\n    \n    return schedule;\n}\n\n// Genereer HTML\nfunction generateSTBHTML(opdrachten, planning) {\n    const today = new Date().toLocaleDateString('nl-NL', {\n        weekday: 'long',\n        year: 'numeric',\n        month: 'long',\n        day: 'numeric'\n    });\n    \n    const inmeetdatum = opdrachten[0]?.inmeetdatum_nl || today;\n    const schedule = calculateSchedule(planning.route);\n    \n    // Bereken totale werktijd afgerond op kwartieren\n    const totaleWerktijdFormatted = roundToQuarter(planning.totaal_minuten);\n    \n    const html = `<!DOCTYPE html>\n<html lang=\"nl\">\n<head>\n    <meta charset=\"UTF-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <title>Inmeetplanning STB-Kozijnen - ${inmeetdatum}</title>\n    <style>\n        :root {\n            --stb-red: #e20613;\n            --stb-red-dark: #b1050f;\n            --stb-red-light: #ff5a66;\n            --ink: #2d2d2d;\n            --muted: #718096;\n            --soft: #f8f9fa;\n            --border: #e2e8f0;\n        }\n        \n        * {\n            margin: 0;\n            padding: 0;\n            box-sizing: border-box;\n        }\n        \n        body {\n            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Helvetica Neue', Arial, sans-serif;\n            background: white;\n            color: var(--ink);\n            line-height: 1.6;\n        }\n        \n        .container {\n            max-width: 800px;\n            margin: 0 auto;\n            padding: 20px;\n        }\n        \n        .header {\n            background: linear-gradient(135deg, var(--stb-red) 0%, var(--stb-red-light) 50%, var(--stb-red-dark) 100%);\n            border-radius: 15px;\n            padding: 25px;\n            color: white;\n            margin-bottom: 20px;\n            position: relative;\n            overflow: hidden;\n        }\n        \n        .header::before {\n            content: '';\n            position: absolute;\n            top: -50%;\n            right: -10%;\n            width: 60%;\n            height: 200%;\n            background: rgba(255, 255, 255, 0.05);\n            transform: rotate(35deg);\n        }\n        \n        .header-content {\n            position: relative;\n            z-index: 2;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .company-branding {\n            display: flex;\n            align-items: center;\n            gap: 15px;\n        }\n        \n        .logo {\n            width: 45px;\n            height: 45px;\n            background: white;\n            border-radius: 10px;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-weight: 800;\n            font-size: 16px;\n            color: var(--stb-red);\n        }\n        \n        .company-info h1 {\n            font-size: 24px;\n            font-weight: 700;\n        }\n        \n        .company-info .tagline {\n            font-size: 12px;\n            opacity: 0.9;\n        }\n        \n        .planning-date {\n            background: rgba(255, 255, 255, 0.2);\n            backdrop-filter: blur(10px);\n            border-radius: 10px;\n            padding: 8px 15px;\n            font-weight: 600;\n            font-size: 14px;\n        }\n        \n        .info-strip {\n            display: flex;\n            gap: 15px;\n            margin-bottom: 15px;\n            flex-wrap: wrap;\n        }\n        \n        .info-badge {\n            background: var(--soft);\n            border: 1px solid var(--border);\n            border-radius: 10px;\n            padding: 10px 15px;\n            flex: 1;\n            min-width: 150px;\n            text-align: center;\n        }\n        \n        .info-badge .label {\n            color: var(--muted);\n            font-size: 11px;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            margin-bottom: 3px;\n        }\n        \n        .info-badge .value {\n            color: var(--ink);\n            font-size: 18px;\n            font-weight: 700;\n        }\n        \n        .contact-info {\n            background: var(--soft);\n            border-radius: 12px;\n            padding: 15px;\n            margin-bottom: 20px;\n            border: 1px solid var(--border);\n        }\n        \n        .contact-content {\n            display: flex;\n            justify-content: space-between;\n            flex-wrap: wrap;\n            gap: 15px;\n        }\n        \n        .contact-block {\n            flex: 1;\n            min-width: 180px;\n        }\n        \n        .contact-block h4 {\n            color: var(--stb-red);\n            font-size: 11px;\n            font-weight: 700;\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            margin-bottom: 4px;\n        }\n        \n        .contact-block p {\n            color: var(--muted);\n            font-size: 12px;\n            margin: 1px 0;\n        }\n        \n        .opdracht-card {\n            background: white;\n            border: 2px solid var(--border);\n            border-radius: 12px;\n            margin-bottom: 15px;\n            overflow: hidden;\n            page-break-inside: avoid;\n        }\n        \n        .opdracht-header {\n            background: linear-gradient(135deg, var(--stb-red), var(--stb-red-light));\n            color: white;\n            padding: 12px 15px;\n            display: flex;\n            justify-content: space-between;\n            align-items: center;\n        }\n        \n        .opdracht-number {\n            background: white;\n            color: var(--stb-red);\n            width: 28px;\n            height: 28px;\n            border-radius: 50%;\n            display: flex;\n            align-items: center;\n            justify-content: center;\n            font-weight: 700;\n            font-size: 14px;\n        }\n        \n        .opdracht-time {\n            font-size: 14px;\n            font-weight: 600;\n        }\n        \n        .opdracht-body {\n            padding: 15px;\n        }\n        \n        .customer-info {\n            margin-bottom: 12px;\n        }\n        \n        .customer-name {\n            font-size: 18px;\n            font-weight: 700;\n            color: var(--ink);\n            margin-bottom: 3px;\n        }\n        \n        .customer-address {\n            color: var(--muted);\n            font-size: 14px;\n        }\n        \n        .customer-contact {\n            margin-top: 5px;\n            font-size: 14px;\n            color: var(--ink);\n        }\n        \n        .customer-phone {\n            color: var(--stb-red);\n            font-weight: 600;\n        }\n        \n        .work-details {\n            display: grid;\n            grid-template-columns: repeat(3, 1fr);\n            gap: 10px;\n            padding: 10px 0;\n            border-top: 1px solid var(--border);\n            border-bottom: 1px solid var(--border);\n            margin: 12px 0;\n        }\n        \n        .work-item {\n            text-align: center;\n        }\n        \n        .work-item .label {\n            font-size: 11px;\n            color: var(--muted);\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n        }\n        \n        .work-item .value {\n            font-size: 16px;\n            font-weight: 700;\n            color: var(--ink);\n        }\n        \n        .elements-section {\n            margin-top: 12px;\n        }\n        \n        .elements-title {\n            font-size: 12px;\n            font-weight: 600;\n            color: var(--muted);\n            text-transform: uppercase;\n            letter-spacing: 0.5px;\n            margin-bottom: 6px;\n        }\n        \n        .elements-content {\n            background: var(--soft);\n            border-radius: 8px;\n            padding: 10px;\n            font-size: 13px;\n            color: var(--ink);\n            line-height: 1.5;\n        }\n        \n        .pause-card {\n            background: linear-gradient(135deg, #fef3c7, #fde68a);\n            border: 2px solid #f59e0b;\n            border-radius: 12px;\n            padding: 15px;\n            margin-bottom: 15px;\n            text-align: center;\n            page-break-inside: avoid;\n        }\n        \n        .pause-title {\n            font-weight: 700;\n            color: #92400e;\n            font-size: 16px;\n        }\n        \n        .pause-time {\n            color: #78350f;\n            font-size: 14px;\n        }\n        \n        @media print {\n            .container {\n                max-width: 100%;\n                padding: 10px;\n            }\n        }\n    </style>\n</head>\n<body>\n    <div class=\"container\">\n        <div class=\"header\">\n            <div class=\"header-content\">\n                <div class=\"company-branding\">\n                    <div class=\"logo\">STB</div>\n                    <div class=\"company-info\">\n                        <h1>STB-Kozijnen</h1>\n                        <div class=\"tagline\">Inmeetplanning</div>\n                    </div>\n                </div>\n                <div class=\"planning-date\">${inmeetdatum}</div>\n            </div>\n        </div>\n        \n        <div class=\"info-strip\">\n            <div class=\"info-badge\">\n                <div class=\"label\">Opdrachten</div>\n                <div class=\"value\">${opdrachten.length}</div>\n            </div>\n            <div class=\"info-badge\">\n                <div class=\"label\">Totale werktijd</div>\n                <div class=\"value\">${totaleWerktijdFormatted}</div>\n            </div>\n            <div class=\"info-badge\">\n                <div class=\"label\">Start locatie</div>\n                <div class=\"value\">Maasbree</div>\n            </div>\n        </div>\n        \n        <div class=\"contact-info\">\n            <div class=\"contact-content\">\n                <div class=\"contact-block\">\n                    <h4>Contact Planning</h4>\n                    <p>📞 +31 774 402 200</p>\n                    <p>✉️ info@stb-kozijnen.nl</p>\n                </div>\n                <div class=\"contact-block\">\n                    <h4>Start locatie</h4>\n                    <p>Groesweg 34A</p>\n                    <p>5993 NN Maasbree</p>\n                </div>\n                <div class=\"contact-block\">\n                    <h4>Werktijden</h4>\n                    <p>Werkdag: 08:00 - 17:00</p>\n                    <p>Pauze: 12:00 - 12:45</p>\n                </div>\n            </div>\n        </div>\n        \n        ${schedule.map((item, idx) => {\n            if (item.isPauze) {\n                return `\n                <div class=\"pause-card\">\n                    <div class=\"pause-title\">☕ Pauze</div>\n                    <div class=\"pause-time\">${item.start_tijd} - ${item.eind_tijd}</div>\n                </div>`;\n            }\n            \n            const opdrachtNr = schedule.filter(s => !s.isPauze).indexOf(item) + 1;\n            const werktijdFormatted = roundToQuarter(item.duur_minuten);\n            \n            return `\n            <div class=\"opdracht-card\">\n                <div class=\"opdracht-header\">\n                    <div class=\"opdracht-number\">${opdrachtNr}</div>\n                    <div class=\"opdracht-time\">${item.start_tijd} - ${item.eind_tijd}</div>\n                </div>\n                <div class=\"opdracht-body\">\n                    <div class=\"customer-info\">\n                        <div class=\"customer-name\">${item.klantnaam}</div>\n                        <div class=\"customer-address\">${(item.volledig_adres || '').replace(/>/g, '')}</div>\n                        <div class=\"customer-contact\">\n                            📞 <span class=\"customer-phone\">${item.telefoon}</span>\n                            ${item.email ? ` • ${item.email}` : ''}\n                        </div>\n                    </div>\n                    \n                    <div class=\"work-details\">\n                        <div class=\"work-item\">\n                            <div class=\"label\">Werktijd</div>\n                            <div class=\"value\">${werktijdFormatted}</div>\n                        </div>\n                        <div class=\"work-item\">\n                            <div class=\"label\">Elementen</div>\n                            <div class=\"value\">${item.aantal_elementen || 0}</div>\n                        </div>\n                        <div class=\"work-item\">\n                            <div class=\"label\">Locaties</div>\n                            <div class=\"value\">${item.aantal_locaties || 0}</div>\n                        </div>\n                    </div>\n                    \n                    ${item.locaties_lijst && item.locaties_lijst.length > 0 ? `\n                    <div class=\"elements-section\">\n                        <div class=\"elements-title\">Gevels / Locaties</div>\n                        <div class=\"elements-content\">\n                            ${item.locaties_lijst.join(' • ')}\n                        </div>\n                    </div>\n                    ` : ''}\n                    \n                    ${item.elementen_lijst && item.elementen_lijst.length > 0 ? `\n                    <div class=\"elements-section\">\n                        <div class=\"elements-title\">Te meten elementen</div>\n                        <div class=\"elements-content\">\n                            ${item.elementen_lijst.join(' • ')}\n                        </div>\n                    </div>\n                    ` : ''}\n                </div>\n            </div>`;\n        }).join('')}\n    </div>\n</body>\n</html>`;\n    \n    return html;\n}\n\nasync function main() {\n    try {\n        // Debug: kijk wat we krijgen\n        console.log('Input type:', typeof $input);\n        console.log('Input all:', $input.all());\n        console.log('First item:', $input.first());\n        \n        // Probeer de juiste manier te vinden\n        let currentItem;\n        \n        // Optie 1: Als het een array is\n        if ($input.all && $input.all().length > 0) {\n            currentItem = $input.first().json;\n        } \n        // Optie 2: Direct item\n        else if ($input.item) {\n            currentItem = $input.item.json;\n        }\n        // Optie 3: Als het al json is\n        else if ($input.json) {\n            currentItem = $input.json;\n        }\n        else {\n            throw new Error('Kan input structuur niet bepalen');\n        }\n        \n        console.log('Current item:', currentItem);\n        \n        // Check structuur\n        if (!currentItem.datum_groep || !currentItem.opdrachten) {\n            throw new Error('Geen datum_groep of opdrachten gevonden in: ' + JSON.stringify(currentItem));\n        }\n        \n        const datumGroep = currentItem.datum_groep;\n        const opdrachten = currentItem.opdrachten;\n        \n        // Skip items zonder datum\n        if (datumGroep.datum_key === 'geen_datum' || opdrachten.length === 0) {\n            return [{\n                json: {\n                    skipped: true,\n                    reason: datumGroep.datum_key === 'geen_datum' ? 'Geen datum' : 'Geen opdrachten',\n                    datum: datumGroep.inmeetdatum_nl\n                }\n            }];\n        }\n        \n        console.log(`Optimaliseren voor ${datumGroep.inmeetdatum_nl}: ${opdrachten.length} opdrachten`);\n        \n        // Rest blijft hetzelfde\n        const geoptimaliseerdeRoute = solveTSP(opdrachten);\n        \n        geoptimaliseerdeRoute.forEach((op, idx) => {\n            console.log(`${idx + 1}. ${op.plaats} (${op.postcode_cijfers}) - ${op.afstand_km} km`);\n        });\n        \n        const totaalMinuten = geoptimaliseerdeRoute.reduce((sum, op) => sum + op.duur_minuten, 0);\n        \n        const planning = {\n            route: geoptimaliseerdeRoute,\n            totaal_minuten: totaalMinuten\n        };\n        \n        const html = generateSTBHTML(geoptimaliseerdeRoute, planning);\n        \n        return [{\n            json: {\n                html: html,\n                planning: planning,\n                opdrachten: geoptimaliseerdeRoute,\n                datum_groep: datumGroep,\n                timestamp: new Date().toISOString()\n            }\n        }];\n        \n    } catch (error) {\n        console.error('Error:', error);\n        return [{\n            json: {\n                error: true,\n                message: error.message,\n                debug_input: $input.all ? $input.all()[0] : 'no input',\n                timestamp: new Date().toISOString()\n            }\n        }];\n    }\n}\n\nreturn main();",
        "mode": "runOnceForEachItem"
      },
      "type": "@kenkaiii/n8n-nodes-supercode.superCodeNodeVmSafe",
      "typeVersion": 1,
      "position": [
        -256,
        1408
      ],
      "id": "bae59ecf-5cb5-4e0a-86be-a7b61ab543dd",
      "name": "Super Code"
    },
    {
      "parameters": {
        "sendTo": "info@stb-kozijnen.nl",
        "subject": "=Inmeetplanning gereed - {{ $('Super Code').item.json.json.opdrachten[0].inmeetdatum_nl }}",
        "message": "=<div style=\"font-family:-apple-system,BlinkMacSystemFont,'Segoe UI','Helvetica Neue',Arial,sans-serif;color:#2d2d2d;line-height:1.55;\">\n  <p>Beste planning,</p>\n  \n  <p>In de bijlage vind je de <strong>inmeetplanning</strong> voor {{ $('Super Code').item.json.json.opdrachten[0].inmeetdatum_nl }}.</p>\n  \n  <div style=\"margin:16px 0; padding:12px; border:1px solid #eee; border-left:4px solid #e20613; background:#fafafa;\">\n    <div>• Start: <strong>08:00 uur vanaf Maasbree</strong></div>\n    <div>• Pauze: <strong>12:00 - 12:45</strong></div>\n    <div>• Route is geoptimaliseerd voor minimale reistijd</div>\n  </div>\n  \n  <p>Met vriendelijke groet,<br/>\n  Automatische Planning</p>\n</div>",
        "options": {
          "attachmentsUi": {
            "attachmentsBinary": [
              {}
            ]
          }
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        1216,
        1408
      ],
      "id": "efe79e5b-0f95-4e23-9456-a70ce40b511d",
      "name": "Send Inmeetplanning",
      "webhookId": "33ef1092-c3f2-4ef4-b4e1-eeb1b689f755",
      "credentials": {
        "gmailOAuth2": {
          "id": "N5VAFdIcBqMdGTwR",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "rules": {
          "values": [
            {
              "conditions": {
                "options": {
                  "caseSensitive": true,
                  "leftValue": "",
                  "typeValidation": "strict",
                  "version": 2
                },
                "conditions": [
                  {
                    "leftValue": "",
                    "rightValue": "",
                    "operator": {
                      "type": "string",
                      "operation": "equals"
                    },
                    "id": "7811c2f2-4ebb-44de-8d9a-5bf76a6b0df3"
                  }
                ],
                "combinator": "and"
              }
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.switch",
      "typeVersion": 3.2,
      "position": [
        0,
        0
      ],
      "id": "3c51863f-67fb-4690-8fb3-387a36adfd1c",
      "name": "Switch1"
    },
    {
      "parameters": {
        "jsCode": "// UPDATED Code Node 1: Parse uitgebreide webhook data en groepeer per datum\nfunction parseWebhookData(htmlContent) {\n    const opdrachten = [];\n    const sections = htmlContent.split('<span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span>');\n    \n    for (const section of sections) {\n        if (!section.trim()) continue;\n        \n        const opdracht = {};\n        \n        // Parse Opdrachtnummer\n        const opdrachtnummerMatch = section.match(/<b>Opdrachtnummer<\\/b><br\\/>(.*?)<br\\//);\n        if (opdrachtnummerMatch) {\n            opdracht.opdrachtnummer = opdrachtnummerMatch[1].trim();\n        }\n        \n        // Parse Klant & Stad (NIEUW FORMAT)\n        const klantStadMatch = section.match(/<b>Klant &amp; Stad<\\/b><br\\/>(.*?)<br\\//);\n        if (klantStadMatch) {\n            const parts = klantStadMatch[1].split(' - ');\n            opdracht.klantnaam = parts[0]?.trim();\n            opdracht.plaats = parts[1]?.trim();\n        }\n        \n        // Fallback voor oude format\n        if (!opdracht.klantnaam) {\n            const klantnaamMatch = section.match(/<b>Klantnaam<\\/b><br\\/>(.*?)<br\\//);\n            if (klantnaamMatch) {\n                opdracht.klantnaam = klantnaamMatch[1].trim();\n            }\n        }\n        \n        // Parse Inmeetdatum (NIEUW)\n        const inmeetdatumMatch = section.match(/<b>Inmeetdatum<\\/b><br\\/>(.*?)<br\\//);\n        if (inmeetdatumMatch) {\n            opdracht.inmeetdatum = inmeetdatumMatch[1].trim();\n            const datum = new Date(inmeetdatumMatch[1].replace(' UTC', ''));\n            opdracht.inmeetdatum_nl = datum.toLocaleDateString('nl-NL', {\n                weekday: 'long',\n                year: 'numeric',\n                month: 'long',\n                day: 'numeric'\n            });\n            // Voeg een simpele datum key toe voor groepering\n            opdracht.datum_key = datum.toISOString().split('T')[0]; // YYYY-MM-DD\n        }\n        \n        // Parse Volledig Adres\n        const adresMatch = section.match(/<b>Volledig Adres<\\/b><br\\/>(.*?)<br\\/(.*?)<br\\//);\n        if (adresMatch) {\n            opdracht.straat = adresMatch[1].trim();\n            opdracht.postcode_plaats = adresMatch[2].trim();\n            opdracht.volledig_adres = `${adresMatch[1].trim()}, ${adresMatch[2].trim()}`;\n            \n            // Extract postcode\n            const postcodeMatch = adresMatch[2].match(/(\\d{4})\\s*([A-Z]{2})/);\n            if (postcodeMatch) {\n                opdracht.postcode = `${postcodeMatch[1]} ${postcodeMatch[2]}`;\n                opdracht.postcode_cijfers = postcodeMatch[1];\n            }\n            \n            // Extract plaats als niet via Klant & Stad gevonden\n            if (!opdracht.plaats) {\n                const plaatsMatch = adresMatch[2].match(/[A-Z]{2}\\s+(.+)$/);\n                if (plaatsMatch) {\n                    opdracht.plaats = plaatsMatch[1].trim();\n                }\n            }\n        }\n        \n        // Parse Uren\n        const urenMatch = section.match(/<b>Uren<\\/b><br\\/>([\\d.]+)/);\n        if (urenMatch) {\n            opdracht.uren = parseFloat(urenMatch[1]);\n            opdracht.duur_minuten = Math.round(parseFloat(urenMatch[1]) * 60);\n        }\n        \n        // Parse Telefoon\n        const telefoonMatch = section.match(/<b>Telefoon<\\/b><br\\/>(.*?)<br\\//);\n        if (telefoonMatch) {\n            opdracht.telefoon = telefoonMatch[1].trim();\n        }\n        \n        // Parse E-mail\n        const emailMatch = section.match(/<b>E-mail<\\/b><br\\/>(.*?)<br\\//);\n        if (emailMatch) {\n            opdracht.email = emailMatch[1].trim();\n        }\n        \n        // Parse Projectstatus\n        const statusMatch = section.match(/>([^<]+)<\\/span>/);\n        if (statusMatch) {\n            opdracht.status = statusMatch[1].trim();\n        }\n        \n        // Parse Planning Notities\n        const notitiesMatch = section.match(/<b>Planning Notities<\\/b><br\\/>(.*?)<br\\//);\n        if (notitiesMatch) {\n            opdracht.planning_notities = notitiesMatch[1].trim();\n            \n            const elementenMatch = notitiesMatch[1].match(/Totaal elementen:\\s*(\\d+)/);\n            if (elementenMatch) {\n                opdracht.aantal_elementen = parseInt(elementenMatch[1]);\n            }\n            \n            const locatiesMatch = notitiesMatch[1].match(/Locaties:\\s*(\\d+)/);\n            if (locatiesMatch) {\n                opdracht.aantal_locaties = parseInt(locatiesMatch[1]);\n            }\n        }\n        \n        // Parse Elementen Overzicht (NIEUW)\n        const elementenOverzichtMatch = section.match(/<b>Elementen Overzicht<\\/b><br\\/>(.*?)<br\\//);\n        if (elementenOverzichtMatch) {\n            opdracht.elementen_overzicht = elementenOverzichtMatch[1].trim();\n            opdracht.elementen_lijst = elementenOverzichtMatch[1]\n                .split(' | ')\n                .map(el => el.trim())\n                .filter(el => el.length > 0);\n        }\n        \n        // Parse Locaties (NIEUW)\n        const locatiesOverzichtMatch = section.match(/<b>Locaties<\\/b><br\\/>(.*?)<br\\//);\n        if (locatiesOverzichtMatch) {\n            opdracht.locaties_overzicht = locatiesOverzichtMatch[1].trim();\n            opdracht.locaties_lijst = locatiesOverzichtMatch[1]\n                .split(' | ')\n                .map(loc => loc.trim())\n                .filter(loc => loc.length > 0);\n        }\n        \n        if (Object.keys(opdracht).length > 0) {\n            opdrachten.push(opdracht);\n        }\n    }\n    \n    return opdrachten;\n}\n\n// Main execution voor N8N\ntry {\n    const inputData = $input.first().json;\n    let htmlContent = null;\n    \n    // Check waar de HTML content staat\n    if (inputData.body && typeof inputData.body === 'object' && inputData.body.viewId) {\n        htmlContent = inputData.body.viewId;\n    } else if (inputData.body && typeof inputData.body === 'string') {\n        htmlContent = inputData.body;\n    } else if (inputData.viewId) {\n        htmlContent = inputData.viewId;\n    }\n    \n    if (!htmlContent || !htmlContent.includes('Opdrachtnummer')) {\n        throw new Error('Geen geldige HTML content gevonden in webhook data');\n    }\n    \n    // Parse de opdrachten\n    const opdrachten = parseWebhookData(htmlContent);\n    \n    if (opdrachten.length === 0) {\n        throw new Error('Geen opdrachten gevonden in de data');\n    }\n    \n    // Groepeer opdrachten per datum\n    const datumGroepen = {};\n    \n    opdrachten.forEach((opdracht, index) => {\n        // Voeg eerst extra velden toe\n        const verrijkteOpdracht = {\n            ...opdracht,\n            volgnummer: index + 1,\n            regio: opdracht.postcode_cijfers ? `Regio ${opdracht.postcode_cijfers.substring(0, 2)}` : 'Onbekend',\n            prioriteit: opdracht.duur_minuten > 120 ? 'Hoog' : 'Normaal',\n            geocode_adres: opdracht.volledig_adres || '',\n            planning_nodig: opdracht.status === 'Planning Vereist',\n            verwerkt_op: new Date().toISOString()\n        };\n        \n        // Groepeer op datum_key\n        const datumKey = verrijkteOpdracht.datum_key || 'geen_datum';\n        \n        if (!datumGroepen[datumKey]) {\n            datumGroepen[datumKey] = {\n                datum_key: datumKey,\n                inmeetdatum: verrijkteOpdracht.inmeetdatum || 'Onbekend',\n                inmeetdatum_nl: verrijkteOpdracht.inmeetdatum_nl || 'Datum onbekend',\n                opdrachten: []\n            };\n        }\n        \n        datumGroepen[datumKey].opdrachten.push(verrijkteOpdracht);\n    });\n    \n    // Log de groepering\n    console.log(`Opdrachten gegroepeerd in ${Object.keys(datumGroepen).length} datum(s)`);\n    Object.keys(datumGroepen).forEach(key => {\n        console.log(`- ${datumGroepen[key].inmeetdatum_nl}: ${datumGroepen[key].opdrachten.length} opdrachten`);\n    });\n    \n    // Return een item per datum-groep\n    const output = [];\n    \n    Object.values(datumGroepen).forEach(groep => {\n        // Bereken postcode groepen voor deze datum\n        const postcodeGroepen = {};\n        groep.opdrachten.forEach(opdracht => {\n            const pc = opdracht.postcode_cijfers || 'onbekend';\n            if (!postcodeGroepen[pc]) {\n                postcodeGroepen[pc] = {\n                    postcode: pc,\n                    plaats: opdracht.plaats || 'Onbekend',\n                    opdrachten: [],\n                    totaal_minuten: 0,\n                    totaal_opdrachten: 0,\n                    totaal_elementen: 0\n                };\n            }\n            postcodeGroepen[pc].opdrachten.push(opdracht.opdrachtnummer);\n            postcodeGroepen[pc].totaal_minuten += opdracht.duur_minuten || 0;\n            postcodeGroepen[pc].totaal_opdrachten++;\n            postcodeGroepen[pc].totaal_elementen += opdracht.aantal_elementen || 0;\n        });\n        \n        // Maak één output item per datum met ALLE opdrachten voor die datum\n        output.push({\n            json: {\n                // Datum groep info\n                datum_groep: {\n                    datum_key: groep.datum_key,\n                    inmeetdatum: groep.inmeetdatum,\n                    inmeetdatum_nl: groep.inmeetdatum_nl,\n                    aantal_opdrachten: groep.opdrachten.length\n                },\n                \n                // Alle opdrachten voor deze datum\n                opdrachten: groep.opdrachten,\n                \n                // Metadata\n                metadata: {\n                    totaal_opdrachten: groep.opdrachten.length,\n                    postcode_groepen: postcodeGroepen,\n                    webhook_url: inputData.webhookUrl || 'onbekend',\n                    execution_mode: inputData.executionMode || 'onbekend'\n                }\n            }\n        });\n    });\n    \n    return output;\n    \n} catch (error) {\n    return [{\n        json: {\n            error: true,\n            message: error.message,\n            input_data: $input.first().json,\n            timestamp: new Date().toISOString()\n        }\n    }];\n}"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        -480,
        1408
      ],
      "id": "1be34a01-e68a-4864-9561-2fcd6518163c",
      "name": "Code Node"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "e6ee955b-c56c-48af-b58e-0c2ce0375630",
              "name": "json.html",
              "value": "={{ $json.json.html }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        -48,
        1408
      ],
      "id": "c5fffe42-9cb1-4b07-b29a-ee036e7f8e48",
      "name": "Edit Fields"
    }
  ],
  "pinData": {
    "Deuren Controle Webhook": [
      {
        "json": {
          "headers": {
            "host": "n8n-klarifai.klarifai.nl",
            "user-agent": "Mozilla/5.0 (compatible; AirtableScripting; +https://airtable.com/developers/scripting;)",
            "content-length": "1418",
            "accept": "*/*",
            "accept-encoding": "gzip, br",
            "cdn-loop": "cloudflare; loops=1",
            "cf-connecting-ip": "54.242.183.191",
            "cf-ipcountry": "US",
            "cf-ray": "9584846a290d8b7e-IAD",
            "cf-visitor": "{\"scheme\":\"https\"}",
            "content-type": "application/json",
            "x-airtable-source": "app9mz6mT0zk8XRGm/wflFV9Ok9DrLvowVx",
            "x-element-id": "1325057RK Peeters Horst - Merk A",
            "x-element-type": "Voordeur",
            "x-forwarded-for": "104.23.213.110",
            "x-forwarded-host": "n8n-klarifai.klarifai.nl",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "0a6048de36f6",
            "x-real-ip": "104.23.213.110",
            "x-source": "airtable-deur-specs"
          },
          "params": {},
          "query": {},
          "body": {
            "event": "complete_deur_specs_approved",
            "timestamp": "2025-07-01T08:26:13.427Z",
            "version": "2.0",
            "deur_specs": {
              "record_id": "rec1T4eecu2I19HhB",
              "element_id": "1325057RK Peeters Horst - Merk A",
              "opdrachtnummer": "1325057RK Peeters Horst",
              "klantnaam": "Janet Peeters",
              "element_type": "Voordeur",
              "locatie": "Begane grond voorgevel",
              "geoffreerde_afmetingen": "1030mm x 2400mm",
              "breedte_mm": 1030,
              "hoogte_mm": 2400,
              "model_deur": "Model 10",
              "type_profiel": "Verdiept",
              "type_kozijn": "Stomp",
              "draairichting": "Wordt met inmeten bepaald",
              "kleur_kozijn_binnen": "Antraciet met Zandstructuur (AP60)",
              "kleur_kozijn_buiten": "Antraciet met Zandstructuur (AP60)",
              "kleur_deurvleugel_binnen": "Antraciet met Zandstructuur (AP60)",
              "kleur_deurvleugel_buiten": "Antraciet met Zandstructuur (AP60)",
              "deurbeslag_buiten": "Standaard RVS",
              "deurbeslag_binnen": "Antraciet",
              "staafgreep_specificatie": "STB trekker P45 van 600mm",
              "scharnieren_binnen": "Antraciet",
              "type_cilinder": "Sleutelcilinder",
              "cilinder_gelijksluitend": "Nee",
              "glas_deurvleugel": "Gezandstraald met heldere rand",
              "brievenbus": "Nee",
              "soort_onderdorpel": "Hardstenen onderdorpel",
              "afwatering": "Onderkant",
              "binnenafwerking": "Kap 6",
              "definitieve_element_prijs": 4197.73,
              "verkoop_review_status": "Gecontroleerd",
              "review_notities": null,
              "opmerkingen_binnendienst": null
            },
            "metadata": {
              "source_base": "STB-Sales",
              "source_table": "Deur Specificaties",
              "target_base": "STB-Productie",
              "target_table": "Deur Elementen"
            }
          },
          "webhookUrl": "https://n8n-klarifai.klarifai.nl/webhook/deuren-review",
          "executionMode": "production"
        }
      }
    ],
    "Elementen Controle Webhook": [
      {
        "json": {
          "headers": {
            "host": "n8n-klarifai.klarifai.nl",
            "user-agent": "Mozilla/5.0 (compatible; AirtableScripting; +https://airtable.com/developers/scripting;)",
            "content-length": "1732",
            "accept": "*/*",
            "accept-encoding": "gzip, br",
            "cdn-loop": "cloudflare; loops=1",
            "cf-connecting-ip": "54.227.77.25",
            "cf-ipcountry": "US",
            "cf-ray": "9565a4e79a16c952-IAD",
            "cf-visitor": "{\"scheme\":\"https\"}",
            "content-type": "application/json",
            "x-airtable-source": "app9mz6mT0zk8XRGm/wflwYrTmjF1xcq2SM",
            "x-data-completeness": "full",
            "x-element-id": "Merk A",
            "x-forwarded-for": "172.68.245.213",
            "x-forwarded-host": "n8n-klarifai.klarifai.nl",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "0a6048de36f6",
            "x-real-ip": "172.68.245.213",
            "x-source": "airtable-complete-record"
          },
          "params": {},
          "query": {},
          "body": {
            "event": "complete_element_approved",
            "timestamp": "2025-06-27T14:30:45.654Z",
            "version": "2.0",
            "element": {
              "record_id": "rec5j0wP4vV4IfSxt",
              "element_id": "Merk A",
              "opdrachtnummer": "1325068RK Engels Grubbenvorst",
              "klantnaam": "Henk Engels",
              "element_type": "Schuifpui 2-delig",
              "locatie": "Begane grond achtergevel",
              "breedte_mm": 2100,
              "hoogte_mm": 2100,
              "geoffreerde_afmetingen": "2100mm x 2100mm",
              "hoofdproduct": "Meerprijs schuifpui 2-delig",
              "hoofdproduct_groep": null,
              "regelitem_1": "Meerprijs schuifpui 2-delig (1x)",
              "regelitem_1_groep": null,
              "regelitem_2": "Meerprijs afwijkende kleur / structuur complete binnen- en buitenzijde (1x)",
              "regelitem_2_groep": null,
              "regelitem_3": "Meerprijs ventilatierooster 1050mm (1x)",
              "regelitem_3_groep": null,
              "element_subtotaal": 4955,
              "element_korting": 0,
              "element_totaal": 4955,
              "definitieve_prijs": 5995.55,
              "verkoop_review_status": "Gecontroleerd",
              "review_notities": null,
              "alle_regelitems_detail": "Meerprijs schuifpui 2-delig: 1x €4425 = €4425\nInclusief HST85 GU thermostep dorpel: 1x €485 = €485\nMeerprijs afwijkende kleur / structuur complete binnen- en buitenzijde: 1x €105 = €105\nMeerprijs ventilatierooster 1050mm: 1x €425 = €425",
              "extra_regelitems": null,
              "auto_cost_lookup_status": null,
              "cost_mapping_notes": null,
              "totaal_regelitems": 4
            },
            "metadata": {
              "source_base": "STB-Sales",
              "target_base": "STB-Productie",
              "record_fetch_method": "complete_record_lookup",
              "fields_available": "all"
            },
            "production_mapping": {
              "element_id": "Element ID (Sales)",
              "element_type": "Element Type (Sales)",
              "locatie": "Plaats",
              "breedte_mm": "Oorspronkelijke Breedte (mm)",
              "hoogte_mm": "Oorspronkelijke Hoogte (mm)",
              "hoofdproduct": "Hoofdproduct",
              "alle_regelitems_detail": "Verkoop Specificaties",
              "review_notities": "Sales Review Notities"
            }
          },
          "webhookUrl": "https://n8n-klarifai.klarifai.nl/webhook/gecontroleerd-trigger",
          "executionMode": "production"
        }
      }
    ],
    "Elementen Controle naar Nacalculatie": [
      {
        "json": {
          "headers": {
            "host": "n8n-klarifai.klarifai.nl",
            "user-agent": "Mozilla/5.0 (compatible; AirtableScripting; +https://airtable.com/developers/scripting;)",
            "content-length": "16973",
            "accept": "*/*",
            "accept-encoding": "gzip, br",
            "cdn-loop": "cloudflare; loops=1",
            "cf-connecting-ip": "3.82.104.16",
            "cf-ipcountry": "US",
            "cf-ray": "96f7b5bbbc648b8b-IAD",
            "cf-visitor": "{\"scheme\":\"https\"}",
            "content-type": "application/json",
            "x-airtable-source": "app9mz6mT0zk8XRGm/wfl5QncMGkzn0FmJZ",
            "x-forwarded-for": "104.23.213.140",
            "x-forwarded-host": "n8n-klarifai.klarifai.nl",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "0a6048de36f6",
            "x-real-ip": "104.23.213.140"
          },
          "params": {},
          "query": {},
          "body": {
            "viewId": "<b>Opdrachtnummer</b><br/>1325071RK<br/><br/><br/><b>Element ID Ref</b><br/>Merk A<br/><br/><br/><b>Element ID</b><br/>1325071RK - Merk A<br/><br/><br/><b>Klantnaam</b><br/>Lucas van Straaten<br/><br/><br/><b>Element Type</b><br/>Voordeur met draaikiepraam als zijlicht<br/><br/><br/><b>Locatie</b><br/>Begane grond voorgevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>1000mm x 2430mm<br/><br/><br/><b>Breedte (mm)</b><br/>1000<br/><br/><br/><b>Hoogte (mm)</b><br/>2430<br/><br/><br/><b>Hoofdproduct</b><br/>Voordeur met draaikiepraam als zijlicht<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(160, 198, 255);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-VD-ST</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€2,237.00<br/><br/><br/><b>Totaal Regelitems</b><br/>3<br/><br/><br/><b>Alle Regelitems Detail</b><br/>Voordeur met draaikiepraam als zijlicht: 1x €2237 = €2237<br/>Korting: 1x €-223.7 = €-223.7<br/>Overige posten (geaggregeerd): 1x €368 = €368<br/><br/><br/><b>Regelitem 1</b><br/>Voordeur met draaikiepraam als zijlicht (1x)<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€2,237.00<br/><br/><br/><b>Regelitem 2</b><br/>Korting (1x)<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>-€223.70<br/><br/><br/><b>Regelitem 3</b><br/>Overige posten (geaggregeerd) (1x)<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€368.00<br/><br/><br/><b>Element Subtotaal</b><br/>€2,381.30<br/><br/><br/><b>Element Korting</b><br/>€178.05<br/><br/><br/><b>Element Totaal</b><br/>€4,147.95<br/><br/><br/><b>Element BTW</b><br/>€871.07<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€5,019.02<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Definitieve Element Prijs</b><br/>€5,019.02<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325071RK<br/><br/><br/><b>Element ID Ref</b><br/>Merk B<br/><br/><br/><b>Element ID</b><br/>1325071RK - Merk B<br/><br/><br/><b>Klantnaam</b><br/>Lucas van Straaten<br/><br/><br/><b>Element Type</b><br/>Vast raam<br/><br/><br/><b>Locatie</b><br/>Begane grond voorgevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>2300mm x 1700mm<br/><br/><br/><b>Breedte (mm)</b><br/>2300<br/><br/><br/><b>Hoogte (mm)</b><br/>1700<br/><br/><br/><b>Hoofdproduct</b><br/>Vast raam<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(209, 226, 255);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-KO-V</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€2,237.00<br/><br/><br/><b>Totaal Regelitems</b><br/>3<br/><br/><br/><b>Alle Regelitems Detail</b><br/>Vast raam: 1x €2237 = €2237<br/>Korting: 1x €-223.7 = €-223.7<br/>Overige posten (geaggregeerd): 1x €368 = €368<br/><br/><br/><b>Regelitem 1</b><br/>Vast raam (1x)<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€2,237.00<br/><br/><br/><b>Regelitem 2</b><br/>Korting (1x)<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>-€223.70<br/><br/><br/><b>Regelitem 3</b><br/>Overige posten (geaggregeerd) (1x)<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€368.00<br/><br/><br/><b>Element Subtotaal</b><br/>€2,381.30<br/><br/><br/><b>Element Korting</b><br/>€223.70<br/><br/><br/><b>Element Totaal</b><br/>€2,381.30<br/><br/><br/><b>Element BTW</b><br/>€500.07<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€2,881.37<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Definitieve Element Prijs</b><br/>€2,881.37<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325071RK<br/><br/><br/><b>Element ID Ref</b><br/>Merk D1. D2.<br/><br/><br/><b>Element ID</b><br/>1325071RK - Merk D1. D2.<br/><br/><br/><b>Klantnaam</b><br/>Lucas van Straaten<br/><br/><br/><b>Element Type</b><br/>D1. Draaikiep raam, D2. 2/3 vast - 1/3 draaikiep raam<br/><br/><br/><b>Locatie</b><br/>Eerste verdieping voorgevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>3500mm x 1100mm<br/><br/><br/><b>Breedte (mm)</b><br/>3500<br/><br/><br/><b>Hoogte (mm)</b><br/>1100<br/><br/><br/><b>Hoofdproduct</b><br/>D1. D2. gekoppeld<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(193, 245, 240);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-KO-VVV</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€2,500.00<br/><br/><br/><b>Totaal Regelitems</b><br/>3<br/><br/><br/><b>Alle Regelitems Detail</b><br/>D1. D2. gekoppeld: 2x €95 = €190<br/>Korting: 1x €-130.7 = €-130.7<br/>Overige posten (geaggregeerd): 1x €401 = €401<br/><br/><br/><b>Regelitem 1</b><br/>D1. D2. gekoppeld (1x)<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€95.00<br/><br/><br/><b>Regelitem 2</b><br/>Korting (1x)<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>-€65.35<br/><br/><br/><b>Regelitem 3</b><br/>Overige posten (geaggregeerd) (1x)<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€200.50<br/><br/><br/><b>Element Subtotaal</b><br/>€788.65<br/><br/><br/><b>Element Korting</b><br/>€65.35<br/><br/><br/><b>Element Totaal</b><br/>€1,266.45<br/><br/><br/><b>Element BTW</b><br/>€265.96<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€1,532.41<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Definitieve Element Prijs</b><br/>€1,532.41<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325071RK<br/><br/><br/><b>Element ID Ref</b><br/>Merk F<br/><br/><br/><b>Element ID</b><br/>1325071RK - Merk F<br/><br/><br/><b>Klantnaam</b><br/>Lucas van Straaten<br/><br/><br/><b>Element Type</b><br/>2/3 vast - 1/3 draaikiep raam<br/><br/><br/><b>Locatie</b><br/>Eerste verdieping achtergevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>1950mm x 1100mm<br/><br/><br/><b>Breedte (mm)</b><br/>1950<br/><br/><br/><b>Hoogte (mm)</b><br/>1100<br/><br/><br/><b>Hoofdproduct</b><br/>2/3 vast - 1/3 draaikiep raam<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 224, 204);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-DK-V</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€1,075.00<br/><br/><br/><b>Totaal Regelitems</b><br/>3<br/><br/><br/><b>Alle Regelitems Detail</b><br/>2/3 vast - 1/3 draaikiep raam: 1x €1075 = €1075<br/>Korting: 1x €-107.5 = €-107.5<br/>Overige posten (geaggregeerd): 1x €196 = €196<br/><br/><br/><b>Regelitem 1</b><br/>2/3 vast - 1/3 draaikiep raam (1x)<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€1,075.00<br/><br/><br/><b>Regelitem 2</b><br/>Korting (1x)<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>-€107.50<br/><br/><br/><b>Regelitem 3</b><br/>Overige posten (geaggregeerd) (1x)<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€196.00<br/><br/><br/><b>Element Subtotaal</b><br/>€1,163.50<br/><br/><br/><b>Element Korting</b><br/>€107.50<br/><br/><br/><b>Element Totaal</b><br/>€1,163.50<br/><br/><br/><b>Element BTW</b><br/>€244.34<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€1,407.83<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Definitieve Element Prijs</b><br/>€1,407.83<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325071RK<br/><br/><br/><b>Element ID Ref</b><br/>Merk C<br/><br/><br/><b>Element ID</b><br/>1325071RK - Merk C<br/><br/><br/><b>Klantnaam</b><br/>Lucas van Straaten<br/><br/><br/><b>Element Type</b><br/>Vast raam<br/><br/><br/><b>Locatie</b><br/>Begane grond voorgevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>2300mm x 1700mm<br/><br/><br/><b>Breedte (mm)</b><br/>2300<br/><br/><br/><b>Hoogte (mm)</b><br/>1700<br/><br/><br/><b>Hoofdproduct</b><br/>Vast raam<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(209, 226, 255);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-KO-V</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€2,081.00<br/><br/><br/><b>Totaal Regelitems</b><br/>3<br/><br/><br/><b>Alle Regelitems Detail</b><br/>Vast raam: 1x €2081 = €2081<br/>Korting: 1x €-208.1 = €-208.1<br/>Overige posten (geaggregeerd): 1x €470 = €470<br/><br/><br/><b>Regelitem 1</b><br/>Vast raam (1x)<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€2,081.00<br/><br/><br/><b>Regelitem 2</b><br/>Korting (1x)<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>-€208.10<br/><br/><br/><b>Regelitem 3</b><br/>Overige posten (geaggregeerd) (1x)<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€470.00<br/><br/><br/><b>Element Subtotaal</b><br/>€2,342.90<br/><br/><br/><b>Element Korting</b><br/>€208.10<br/><br/><br/><b>Element Totaal</b><br/>€0.00<br/><br/><br/><b>Element BTW</b><br/>€0.00<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€0.00<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Definitieve Element Prijs</b><br/>€0.00<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325071RK<br/><br/><br/><b>Element ID Ref</b><br/>Merk G<br/><br/><br/><b>Element ID</b><br/>1325071RK - Merk G<br/><br/><br/><b>Klantnaam</b><br/>Lucas van Straaten<br/><br/><br/><b>Element Type</b><br/>Draaistolp - draaikiep raam<br/><br/><br/><b>Locatie</b><br/>Eerste verdieping achtergevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>1280mm x 1100mm<br/><br/><br/><b>Breedte (mm)</b><br/>1280<br/><br/><br/><b>Hoogte (mm)</b><br/>1100<br/><br/><br/><b>Hoofdproduct</b><br/>Draaistolp - draaikiep raam<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 212, 224);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-KO-DK-D</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€518.00<br/><br/><br/><b>Totaal Regelitems</b><br/>3<br/><br/><br/><b>Alle Regelitems Detail</b><br/>Draaistolp - draaikiep raam: 1x €518 = €518<br/>Korting: 1x €-51.8 = €-51.8<br/>Overige posten (geaggregeerd): 1x €103 = €103<br/><br/><br/><b>Regelitem 1</b><br/>Draaistolp - draaikiep raam (1x)<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€518.00<br/><br/><br/><b>Regelitem 2</b><br/>Korting (1x)<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>-€51.80<br/><br/><br/><b>Regelitem 3</b><br/>Overige posten (geaggregeerd) (1x)<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€103.00<br/><br/><br/><b>Element Subtotaal</b><br/>€569.20<br/><br/><br/><b>Element Korting</b><br/>€51.80<br/><br/><br/><b>Element Totaal</b><br/>€569.20<br/><br/><br/><b>Element BTW</b><br/>€119.53<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€688.73<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Definitieve Element Prijs</b><br/>€688.73<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325071RK<br/><br/><br/><b>Element ID Ref</b><br/>Merk E<br/><br/><br/><b>Element ID</b><br/>1325071RK - Merk E<br/><br/><br/><b>Klantnaam</b><br/>Lucas van Straaten<br/><br/><br/><b>Element Type</b><br/>2/3 vast - 1/3 draaikiep raam<br/><br/><br/><b>Locatie</b><br/>Eerste verdieping voorgevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>1950mm x 1100mm<br/><br/><br/><b>Breedte (mm)</b><br/>1950<br/><br/><br/><b>Hoogte (mm)</b><br/>1100<br/><br/><br/><b>Hoofdproduct</b><br/>2/3 vast - 1/3 draaikiep raam<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 224, 204);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-DK-V</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€1,307.00<br/><br/><br/><b>Totaal Regelitems</b><br/>3<br/><br/><br/><b>Alle Regelitems Detail</b><br/>2/3 vast - 1/3 draaikiep raam: 1x €1307 = €1307<br/>Korting: 1x €-130.7 = €-130.7<br/>Overige posten (geaggregeerd): 1x €206 = €206<br/><br/><br/><b>Regelitem 1</b><br/>2/3 vast - 1/3 draaikiep raam (1x)<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€1,307.00<br/><br/><br/><b>Regelitem 2</b><br/>Korting (1x)<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>-€130.70<br/><br/><br/><b>Regelitem 3</b><br/>Overige posten (geaggregeerd) (1x)<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€206.00<br/><br/><br/><b>Element Subtotaal</b><br/>€1,382.30<br/><br/><br/><b>Element Korting</b><br/>€130.70<br/><br/><br/><b>Element Totaal</b><br/>€1,382.30<br/><br/><br/><b>Element BTW</b><br/>€290.28<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€1,672.58<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Definitieve Element Prijs</b><br/>€1,672.58<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325071RK<br/><br/><br/><b>Element ID Ref</b><br/>Merk H<br/><br/><br/><b>Element ID</b><br/>1325071RK - Merk H<br/><br/><br/><b>Klantnaam</b><br/>Lucas van Straaten<br/><br/><br/><b>Element Type</b><br/>Vast raam<br/><br/><br/><b>Locatie</b><br/>Tweede verdieping voorgevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>630mm x 740mm<br/><br/><br/><b>Breedte (mm)</b><br/>630<br/><br/><br/><b>Hoogte (mm)</b><br/>740<br/><br/><br/><b>Hoofdproduct</b><br/>Vast raam<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(209, 226, 255);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-KO-V</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€1,184.00<br/><br/><br/><b>Totaal Regelitems</b><br/>3<br/><br/><br/><b>Alle Regelitems Detail</b><br/>Vast raam: 1x €1184 = €1184<br/>Korting: 1x €-118.4 = €-118.4<br/>Overige posten (geaggregeerd): 1x €237 = €237<br/><br/><br/><b>Regelitem 1</b><br/>Vast raam (1x)<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€1,184.00<br/><br/><br/><b>Regelitem 2</b><br/>Korting (1x)<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>-€118.40<br/><br/><br/><b>Regelitem 3</b><br/>Overige posten (geaggregeerd) (1x)<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€237.00<br/><br/><br/><b>Element Subtotaal</b><br/>€1,065.60<br/><br/><br/><b>Element Korting</b><br/>€118.40<br/><br/><br/><b>Element Totaal</b><br/>€1,065.60<br/><br/><br/><b>Element BTW</b><br/>€223.78<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€0.00<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:1px 8px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Definitieve Element Prijs</b><br/>€0.00<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span>"
          },
          "webhookUrl": "https://n8n-klarifai.klarifai.nl/webhook/inmeetplanning",
          "executionMode": "production"
        }
      }
    ],
    "Elementen Controle naar Nacalculatie1": [
      {
        "json": {
          "headers": {
            "host": "n8n-klarifai.klarifai.nl",
            "user-agent": "Mozilla/5.0 (compatible; AirtableScripting; +https://airtable.com/developers/scripting;)",
            "content-length": "7564",
            "accept": "*/*",
            "accept-encoding": "gzip, br",
            "cdn-loop": "cloudflare; loops=1",
            "cf-connecting-ip": "44.223.25.157",
            "cf-ipcountry": "US",
            "cf-ray": "97c18b302d84d6c4-IAD",
            "cf-visitor": "{\"scheme\":\"https\"}",
            "content-type": "application/json",
            "x-airtable-source": "app9mz6mT0zk8XRGm/wfltnvni1zbgKzC63",
            "x-forwarded-for": "172.71.194.251",
            "x-forwarded-host": "n8n-klarifai.klarifai.nl",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "0a6048de36f6",
            "x-real-ip": "172.71.194.251"
          },
          "params": {},
          "query": {},
          "body": {
            "viewId": "<b>Opdrachtnummer</b><br/>1325081RK Shamal Lomm<br/><br/><br/><b>Element ID Ref</b><br/>Jay Shamal-A<br/><br/><br/><b>Element ID</b><br/>A<br/><br/><br/><b>Klantnaam</b><br/>Jay Shamal<br/><br/><br/><b>Element Type</b><br/>1/3 Draaikiep - 2/3 vast raam met bovenlichten inclusief<br/><br/><br/><b>Locatie</b><br/>Begane grond zijgevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>3000x600mm<br/><br/><br/><b>Breedte (mm)</b><br/>3000<br/><br/><br/><b>Hoogte (mm)</b><br/>600<br/><br/><br/><b>Hoofdproduct</b><br/>1/3 Draaikiep - 2/3 vast raam met bovenlichten inclusief<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(209, 226, 255);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-KO-V</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€3,621.00<br/><br/><br/><b>Totaal Regelitems</b><br/>2<br/><br/><br/><b>Alle Regelitems Detail</b><br/>Hardstenen raamdorpel: 1x €3621 = €3621<br/>Insectenhor: 1x €3621 = €3621<br/><br/><br/><b>Regelitem 1</b><br/>Hardstenen raamdorpel<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 2</b><br/>Insectenhor<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 3</b><br/>{{ $json[&quot;Regelitem 3&quot;] }}<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 4</b><br/>{{ $json[&quot;Regelitem 4&quot;] }}<br/><br/><br/><b>Regelitem 4 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 5</b><br/>{{ $json[&quot;Regelitem 5&quot;] }}<br/><br/><br/><b>Regelitem 5 Prijs</b><br/>€0.00<br/><br/><br/><b>Element Subtotaal</b><br/>€0.00<br/><br/><br/><b>Element Korting</b><br/>€0.00<br/><br/><br/><b>Element Totaal</b><br/>€0.00<br/><br/><br/><b>Element BTW</b><br/>€0.00<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€0.00<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Regelitem 6 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 7 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 8 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 9 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 10 Prijs</b><br/>€0.00<br/><br/><br/><b>Definitieve Element Prijs</b><br/>€0.00<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325081RK Shamal Lomm<br/><br/><br/><b>Element ID Ref</b><br/>Jay Shamal-B<br/><br/><br/><b>Element ID</b><br/>B<br/><br/><br/><b>Klantnaam</b><br/>Jay Shamal<br/><br/><br/><b>Element Type</b><br/>1/3 Draaikiep - 2/3 vast raam met bovenlichten inclusief<br/><br/><br/><b>Locatie</b><br/>Begane grond zijgevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>3000x600mm<br/><br/><br/><b>Breedte (mm)</b><br/>3000<br/><br/><br/><b>Hoogte (mm)</b><br/>600<br/><br/><br/><b>Hoofdproduct</b><br/>1/3 Draaikiep - 2/3 vast raam met bovenlichten inclusief<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(209, 226, 255);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-KO-V</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€3,621.00<br/><br/><br/><b>Totaal Regelitems</b><br/>2<br/><br/><br/><b>Alle Regelitems Detail</b><br/>Hardstenen raamdorpel: 1x €3621 = €3621<br/>Insectenhor: 1x €3621 = €3621<br/><br/><br/><b>Regelitem 1</b><br/>Hardstenen raamdorpel<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 2</b><br/>Insectenhor<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 3</b><br/>{{ $json[&quot;Regelitem 3&quot;] }}<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 4</b><br/>{{ $json[&quot;Regelitem 4&quot;] }}<br/><br/><br/><b>Regelitem 4 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 5</b><br/>{{ $json[&quot;Regelitem 5&quot;] }}<br/><br/><br/><b>Regelitem 5 Prijs</b><br/>€0.00<br/><br/><br/><b>Element Subtotaal</b><br/>€0.00<br/><br/><br/><b>Element Korting</b><br/>€0.00<br/><br/><br/><b>Element Totaal</b><br/>€0.00<br/><br/><br/><b>Element BTW</b><br/>€0.00<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€0.00<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Regelitem 6 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 7 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 8 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 9 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 10 Prijs</b><br/>€0.00<br/><br/><br/><b>Definitieve Element Prijs</b><br/>€0.00<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325081RK Shamal Lomm<br/><br/><br/><b>Element ID Ref</b><br/>Jay Shamal-C<br/><br/><br/><b>Element ID</b><br/>C<br/><br/><br/><b>Klantnaam</b><br/>Jay Shamal<br/><br/><br/><b>Element Type</b><br/>Draaikiep - vast raam - draaikiep raam met bovenlichten<br/><br/><br/><b>Locatie</b><br/>Begane grond zijgevel<br/><br/><br/><b>Geoffreerde Afmetingen</b><br/>4000x600mm<br/><br/><br/><b>Breedte (mm)</b><br/>4000<br/><br/><br/><b>Hoogte (mm)</b><br/>600<br/><br/><br/><b>Hoofdproduct</b><br/>Draaikiep - vast raam - draaikiep raam met bovenlichten<br/><br/><br/><b>Hoofdproduct Groep</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(209, 226, 255);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">STB-KO-V</span><br/><br/><br/><b>Hoofdproduct Prijs</b><br/>€0.00<br/><br/><br/><b>Totaal Regelitems</b><br/>0<br/><br/><br/><b>Regelitem 1 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 2 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 3</b><br/>{{ $json[&quot;Regelitem 3&quot;] }}<br/><br/><br/><b>Regelitem 3 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 4</b><br/>{{ $json[&quot;Regelitem 4&quot;] }}<br/><br/><br/><b>Regelitem 4 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 5</b><br/>{{ $json[&quot;Regelitem 5&quot;] }}<br/><br/><br/><b>Regelitem 5 Prijs</b><br/>€0.00<br/><br/><br/><b>Element Subtotaal</b><br/>€0.00<br/><br/><br/><b>Element Korting</b><br/>€0.00<br/><br/><br/><b>Element Totaal</b><br/>€0.00<br/><br/><br/><b>Element BTW</b><br/>€0.00<br/><br/><br/><b>Element Totaal Incl BTW</b><br/>€0.00<br/><br/><br/><b>Verkoop Review Status</b><br/><span style=\"color:rgb(255, 255, 255);background-color:rgb(4, 138, 14);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Gecontroleerd</span><br/><br/><br/><b>Regelitem 6 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 7 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 8 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 9 Prijs</b><br/>€0.00<br/><br/><br/><b>Regelitem 10 Prijs</b><br/>€0.00<br/><br/><br/><b>Definitieve Element Prijs</b><br/>€0.00<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span>"
          },
          "webhookUrl": "https://n8n-klarifai.klarifai.nl/webhook/nacalculatie",
          "executionMode": "production"
        }
      }
    ],
    "Inmeetplanning": [
      {
        "json": {
          "headers": {
            "host": "n8n-klarifai.klarifai.nl",
            "user-agent": "Mozilla/5.0 (compatible; AirtableScripting; +https://airtable.com/developers/scripting;)",
            "content-length": "9647",
            "accept": "*/*",
            "accept-encoding": "gzip, br",
            "cdn-loop": "cloudflare; loops=1",
            "cf-connecting-ip": "44.200.147.157",
            "cf-ipcountry": "US",
            "cf-ray": "97c6e5dbef637ff1-IAD",
            "cf-visitor": "{\"scheme\":\"https\"}",
            "content-type": "application/json",
            "x-airtable-source": "appuXCPmvIwowH78k/wflHG3UX2DfHbCRmW",
            "x-forwarded-for": "172.70.134.56",
            "x-forwarded-host": "n8n-klarifai.klarifai.nl",
            "x-forwarded-port": "443",
            "x-forwarded-proto": "https",
            "x-forwarded-server": "0a6048de36f6",
            "x-real-ip": "172.70.134.56"
          },
          "params": {},
          "query": {},
          "body": {
            "viewId": "<b>Opdrachtnummer</b><br/>1325080RK Schatorie Horst<br/><br/><br/><b>Klant &amp; Stad</b><br/>Jos Schatorie - Horst<br/><br/><br/><b>Inmeetdatum</b><br/>September 15, 2025 UTC<br/><br/><br/><b>Volledig Adres</b><br/>Hertog Willemlaan 1A<br/>5961 TK Horst<br/><br/><br/><b>Uren</b><br/>0.9<br/><br/><br/><b>Telefoon</b><br/>0649598112<br/><br/><br/><b>E-mail</b><br/>rita.josschat@gmail.com<br/><br/><br/><b>Projectstatus</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 182, 142);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Planning Vereist</span><br/><br/><br/><b>Planning Notities</b><br/>Totaal elementen: 3 | Locaties: 2 verschillende gebieden | Geschat: 0.9 uur (54 min)<br/><br/><br/><b>Elementen Overzicht</b><br/>Merk A (Vast raam met borstwering) | Merk B (Draaikiep raam met borstwering) | Merk C (Draaikiep raam met borstwering)<br/><br/><br/><b>Locaties</b><br/>Begane grond voorgevel | Eerste verdieping voorgevel<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325081RK Shamal Lomm<br/><br/><br/><b>Klant &amp; Stad</b><br/>Jay Shamal - Lomm<br/><br/><br/><b>Inmeetdatum</b><br/>September 15, 2025 UTC<br/><br/><br/><b>Volledig Adres</b><br/>Bosbergstraat 4<br/>5943 AM Lomm<br/><br/><br/><b>Uren</b><br/>0.9<br/><br/><br/><b>Telefoon</b><br/>0681486988<br/><br/><br/><b>E-mail</b><br/>giemalen@hotmail.com<br/><br/><br/><b>Projectstatus</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 182, 142);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Planning Vereist</span><br/><br/><br/><b>Planning Notities</b><br/>Totaal elementen: 3 | Locaties: 1 verschillende gebieden | Geschat: 0.9 uur (54 min)<br/><br/><br/><b>Elementen Overzicht</b><br/>Merk A (1/3 Draaikiep - 2/3 vast raam met bovenlichten inclusief) | Merk B (1/3 Draaikiep - 2/3 vast raam met bovenlichten inclusief) | Merk C (Draaikiep - vast raam - draaikiep raam met bovenlichten)<br/><br/><br/><b>Locaties</b><br/>Begane grond zijgevel<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325082RK Schaper Venlo<br/><br/><br/><b>Klant &amp; Stad</b><br/>Paul Schaper - Venlo<br/><br/><br/><b>Inmeetdatum</b><br/>September 15, 2025 UTC<br/><br/><br/><b>Volledig Adres</b><br/>Herungerberg 284C<br/>5916 BD Venlo<br/><br/><br/><b>Uren</b><br/>0.9<br/><br/><br/><b>Telefoon</b><br/>0621441415<br/><br/><br/><b>E-mail</b><br/>paul_schaper@live.nl<br/><br/><br/><b>Projectstatus</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 182, 142);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Planning Vereist</span><br/><br/><br/><b>Planning Notities</b><br/>Totaal elementen: 3 | Locaties: 3 verschillende gebieden | Geschat: 0.9 uur (54 min)<br/><br/><br/><b>Elementen Overzicht</b><br/>Merk A (Voordeur) | Merk B (Achterdeur met borstwering) | Merk C (Dubbele plisséhordeur)<br/><br/><br/><b>Locaties</b><br/>Begane grond zijgevel | Begane grond achtergevel | Tuindeuren achtergevel<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325083RK Coenen Belfeld<br/><br/><br/><b>Klant &amp; Stad</b><br/>Jesse Coenen - Belfeld<br/><br/><br/><b>Inmeetdatum</b><br/>September 15, 2025 UTC<br/><br/><br/><b>Volledig Adres</b><br/>Soersbeekweg 66<br/>5951 HB Belfeld<br/><br/><br/><b>Uren</b><br/>2.5<br/><br/><br/><b>Telefoon</b><br/>0637449293<br/><br/><br/><b>E-mail</b><br/>coenenjesse@gmail.com<br/><br/><br/><b>Projectstatus</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 182, 142);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Planning Vereist</span><br/><br/><br/><b>Planning Notities</b><br/>Totaal elementen: 13 | Locaties: 6 verschillende gebieden | Geschat: 3.9 uur (234 min)<br/><br/><br/><b>Elementen Overzicht</b><br/>Merk A (Vast raam) | Merk B1. B2 (B1. Vast raam) | Merk C1. C2 (C1. Achterdeur met borstwering en bovenlicht) | Merk D (Schuifpui 2-delig) | Merk E (Voordeur met zijlicht) | Merk F (Draaikiep raam) | Merk G (Draaikiep raam) | Merk H (Draaikiep raam) | Merk I (Draaikiep raam) | Merk J (Draaikiep raam) | Merk K (Draaistolp - draaikiep raam) | Merk L (Keylite dakraam (type 08)) | Merk M (Keylite dakraam (type 08))<br/><br/><br/><b>Locaties</b><br/>Begane grond voorgevel | B1. Begane grond voorgevel | Begane grond achtergevel | Eerste verdieping zijgevel | Eerste verdieping voorgevel | Eerste verdieping achtergevel<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325084RK Jansen Venlo<br/><br/><br/><b>Klant &amp; Stad</b><br/>Rudy Jansen - Venlo<br/><br/><br/><b>Inmeetdatum</b><br/>September 17, 2025 UTC<br/><br/><br/><b>Volledig Adres</b><br/>Waterhoenstraat 16<br/>5912 XV Venlo<br/><br/><br/><b>Uren</b><br/>1.5<br/><br/><br/><b>Telefoon</b><br/>0626384725<br/><br/><br/><b>E-mail</b><br/>rudyjansen1@home.nl<br/><br/><br/><b>Projectstatus</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 182, 142);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Planning Vereist</span><br/><br/><br/><b>Planning Notities</b><br/>Totaal elementen: 5 | Locaties: 3 verschillende gebieden | Geschat: 1.5 uur (90 min)<br/><br/><br/><b>Elementen Overzicht</b><br/>Merk A (Vast raam) | Merk B (Draaistolp - draaikiep raam) | Merk C (Draaikiep - vast - draaikiep raam) | Merk D (Klemhorren) | Merk E (Klemhorren)<br/><br/><br/><b>Locaties</b><br/>Begane grond voorgevel | Eerste verdieping voorgevel | Eerste verdieping achtergevel<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325085RK Nijssen Baarlo<br/><br/><br/><b>Klant &amp; Stad</b><br/>Laura Nijssen - Baarlo<br/><br/><br/><b>Inmeetdatum</b><br/>September 17, 2025 UTC<br/><br/><br/><b>Volledig Adres</b><br/>Molenberg 20<br/>5991 AL Baarlo<br/><br/><br/><b>Uren</b><br/>0.9<br/><br/><br/><b>Telefoon</b><br/>0636194323<br/><br/><br/><b>E-mail</b><br/>lauranijssen94@hotmail.com<br/><br/><br/><b>Projectstatus</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 182, 142);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Planning Vereist</span><br/><br/><br/><b>Planning Notities</b><br/>Totaal elementen: 3 | Locaties: 3 verschillende gebieden | Geschat: 0.9 uur (54 min)<br/><br/><br/><b>Elementen Overzicht</b><br/>Merk A (Draaikiep - vast raam) | Merk B (Draaistolp - draaikiep raam) | Merk C (Dubbele tuindeuren met zijlichten)<br/><br/><br/><b>Locaties</b><br/>Begane grond zijgevel | Eerste verdieping achtergevel | Begane grond achtergevel<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325086RK Egelmeers Hegelsom - 2<br/><br/><br/><b>Klant &amp; Stad</b><br/>Thijs Egelmeers - Hegelsom<br/><br/><br/><b>Inmeetdatum</b><br/>September 22, 2025 UTC<br/><br/><br/><b>Volledig Adres</b><br/>Snellenstraat 5<br/>5963 AX Hegelsom<br/><br/><br/><b>Uren</b><br/>0.3<br/><br/><br/><b>Telefoon</b><br/>0642954934<br/><br/><br/><b>E-mail</b><br/>thijsegelmeers@live.nl<br/><br/><br/><b>Projectstatus</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 182, 142);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Planning Vereist</span><br/><br/><br/><b>Planning Notities</b><br/>Totaal elementen: 1 | Locaties: 1 verschillende gebieden | Geschat: 0.3 uur (18 min)<br/><br/><br/><b>Elementen Overzicht</b><br/>Merk A (Voordeur)<br/><br/><br/><b>Locaties</b><br/>Begane grond voorgevel<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span><br/><b>Opdrachtnummer</b><br/>1325087RK Burhenne Venlo - 2<br/><br/><br/><b>Klant &amp; Stad</b><br/>Angelique Burhenne - Venlo<br/><br/><br/><b>Uiterlijke montagedatum</b><br/>9/22/2025 UTC<br/><br/><br/><b>Volledig Adres</b><br/>Krekelveldstraat 8<br/>5912GB Venlo<br/><br/><br/><b>Uren</b><br/>1.8<br/><br/><br/><b>Telefoon</b><br/>0654327622<br/><br/><br/><b>E-mail</b><br/>ayburhenne@gmail.com<br/><br/><br/><b>Projectstatus</b><br/><span style=\"color:rgb(49, 53, 62);background-color:rgb(255, 182, 142);padding:3px 8px 4px;margin-right:4px;border-radius:9999px;font-size:13px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis\">Planning Vereist</span><br/><br/><br/><b>Planning Notities</b><br/>Totaal elementen: 6 | Locaties: 4 verschillende gebieden | Geschat: 1.8 uur (108 min)<br/><br/><br/><b>Elementen Overzicht</b><br/>Merk A (Draaikiep raam) | Merk B (Draaikiep - vast raam) | Merk C (Draaikiep - vast raam) | Merk D (Draaikiep raam) | Merk E1. E2 (E1. Vast raam) | Merk F (Vast raam)<br/><br/><br/><b>Locaties</b><br/>Eerste verdieping achtergevel | Eerste verdieping voorgevel | Begane grond voorgevel | Kelder voorgevel<br/><br/><br/><span style=\"display:inline-block;height:1px;width:100%;background-color:#999\"> </span>"
          },
          "webhookUrl": "https://n8n-klarifai.klarifai.nl/webhook/inmeetplanning",
          "executionMode": "production"
        }
      }
    ]
  },
  "connections": {
    "Code1": {
      "main": [
        [
          {
            "node": "Airtable Kozijn Elementen",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code2": {
      "main": [
        [
          {
            "node": "Airtable Deur Elementen",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Switch": {
      "main": [
        [
          {
            "node": "Code1",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code3",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code4",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "Code5",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code3": {
      "main": [
        [
          {
            "node": "Airtable Rolluik Elementen",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code4": {
      "main": [
        [
          {
            "node": "Airtable Dakraam Elementen",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code5": {
      "main": [
        [
          {
            "node": "Airtable Gevelbekleding Elementen",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Facturen Webhook": {
      "main": [
        [
          {
            "node": "Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Deuren Controle Webhook": {
      "main": [
        [
          {
            "node": "Code2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Elementen Controle Webhook": {
      "main": [
        [
          {
            "node": "Switch",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code": {
      "main": [
        [
          {
            "node": "HTML Generator",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML Generator": {
      "main": [
        [
          {
            "node": "PDFco Api1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Inmeetplanning": {
      "main": [
        [
          {
            "node": "Code Node",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PDFco Api1": {
      "main": [
        [
          {
            "node": "HTTP Request",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request": {
      "main": [
        [
          {
            "node": "Send a message",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Elementen Controle naar Nacalculatie": {
      "main": [
        [
          {
            "node": "Code7",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code7": {
      "main": [
        [
          {
            "node": "Split Out",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "PDFco Api2": {
      "main": [
        [
          {
            "node": "HTTP Request1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTTP Request1": {
      "main": [
        [
          {
            "node": "Send Inmeetplanning",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Split Out": {
      "main": [
        [
          {
            "node": "Execute a SQL query",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Execute a SQL query": {
      "main": [
        [
          {
            "node": "Create or update a record",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Elementen Controle naar Nacalculatie1": {
      "main": [
        [
          {
            "node": "HTML Generator 2.0",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "HTML Generator 2.0": {
      "main": [
        [
          {
            "node": "PDFco Api",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Super Code": {
      "main": [
        [
          {
            "node": "Edit Fields",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Code Node": {
      "main": [
        [
          {
            "node": "Super Code",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Edit Fields": {
      "main": [
        [
          {
            "node": "PDFco Api2",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "active": true,
  "settings": {
    "executionOrder": "v1"
  },
  "versionId": "20e1bcd0-5dd9-4bdc-b294-c0f840039a4c",
  "meta": {
    "templateCredsSetupCompleted": true,
    "instanceId": "d9180333bb70e1bc04809edaea0ae46e4bb0db815692ca6139746363fe3bf1ae"
  },
  "id": "x5seNP2f5rUdm8ai",
  "tags": []
}